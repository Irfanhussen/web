<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CICD - HCM Approval & Migration Form</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            /* Set the font family to Roboto */
            margin: 0;
            /* Remove default margin */
            padding: 0;
            /* Remove default padding */
            display: flex;
            justify-content: center;
            align-items: center;
            /*height: 100vh; /* Center content vertically */
            background-color: #f0f0f0;
            /* Light background color */
            box-sizing: border-box;
            /* Ensure consistent box sizing */
        }

        .hidden {
            visibility: hidden;
        }

        .visible {
            visibility: visible;
        }

        .green-label {
            color: green;
        }

        .green-checkbox {
            background-color: green;
            border: 1px solid green;
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
        }

        .green-checkbox input[type="checkbox"]:checked+.green-checkbox-label::before {
            content: '✔';
            color: white;
            display: block;
            text-align: center;
        }

        .green-checkbox-label {
            display: inline-block;
            vertical-align: middle;
        }

        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            //height: 100vh;
            background-color: lightgrey;
        }

        .header {
            background-color: white;
            color: darkblue;
            display: flex;
            margin-bottom: 5px;
            /* Add margin to separate the header from the form */
            margin: 0;
            /* Ensure no margin around the header */
            justify-content: space-between;
            align-items: center;
            padding: 0px 2px 2px 2px;
            /* Add padding for breathing room */
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            /* Add margin to separate the header from the form */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            /* Add subtle shadow for highlight */
            height: 8vh;
            /* Center content vertically */
        }

        .indicator {
            padding: 5px;
            color: red;
            display: inline;
        }

        .header-left,
        .header-right {
            text-align: left;
            margin: -5px;
            margin-top: -20px;
        }

        .header-right .user-guide {
            margin-bottom: 55px;
            text-align: left;
            color: red;
            margin-left: 30px;
        }

        .header-right .download-button {
            margin-top: -60px;
        }

        .header-right button {
            font-size: 16px;
            padding: 5px 10px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }

        .logo {
            height: 65px;
            /* Adjust height as needed */
            margin-right: 15px;
            /* Space between logos */
        }

        .header-right button {
            padding: 5px 10px;
            background-color: darkblue;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .content {
            margin: 20px 0;
            /* Adjust margin as needed */
        }

        .line-container {
            display: flex;
            cursor: pointer;
            align-items: center;
            margin: 20px 0;
            /* Adjust margin as needed */
        }

        #line-container:hover {
            text-decoration: underline;
        }

        #arrowIcon {
            display: inline-block;
            margin-left: 5px;
        }

        .short-line {
            width: 50px;
            /* Adjust the length of the short line */
            border-bottom: 2px solid darkblue;
            /* Style the line with a solid color */
        }

        .line-text {
            margin: 0 10px;
            /* Space around the text */
            color: Black;
            background-color: white;
            /* Background color for the text */
            padding: 0 5px;
            /* Padding around the text */
            font-weight: bold;
            /* Make the text bold */
            white-space: nowrap;
            /* Prevent text from wrapping */
        }

        .long-line {
            flex-grow: 1;
            border-bottom: 2px solid darkblue;
            /* Style the line with a solid color */
            margin-right: 10px;
            /* Space between the line and the button */
        }

        .file-upload button {
            padding: 4px;
            background-color: darkblue;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .grid-container-6 {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
        }

        .grid-container-2 {
            display: grid;
            grid-template-columns: 113px 123px;
            /* Different widths for each column */
            gap: 2px;
        }

        .grid-container-8 {
            display: grid;
            grid-template-columns: 113px 65px 110px 65px 160px 65px 115px 120px 130px 30px;
            /* Different widths for each column */
            gap: 5px;
        }

        .grid-container-custom {
            display: grid;
            grid-template-columns: 113px 255px 85px 65px 310px;
            /* Different widths for each column */
            gap: 5px;
        }

        .grid-container-eight {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 10px;
        }

        .grid-container-three {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .grid-container-four {
            display: flex;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        /* Additional styles to ensure proper alignment and appearance */
        .grid-container-8 select,
        .grid-container-8 input {
            width: 100%;
            /* Make the input and select elements take up the full width of their grid cell */
            padding: 5px;
            /* Add padding inside the input and select elements */
            box-sizing: border-box;
            /* Ensure padding does not affect the width */
        }

        /* Span the GitHub URL input across two columns */
        .github-url {
            grid-column: span 2;
        }

        .grid-container-7 {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .grid-container-9 {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 10px;
        }

        #manual {
            color: darkblue
        }

        .label {
            text-align: left;
            color: black;
            font-weight: normal;
            font-size: 12px;
        }

        .control {
            text-align: left;
            font-weight: normal;
            border: 1px solid darkblue;
            padding: 3px;
            /* Adjust padding for dropdown size */
            font-size: 11px;
            /* Adjust font size for dropdown size */
            color: black;
        }

        .span-2 {
            grid-column: span 2;
        }

        .span-3 {
            grid-column: span 3;
        }

        .span-4 {
            grid-column: span 4;
        }

        .span-5 {
            grid-column: span 5;
        }

        .span-7 {
            grid-column: span 7;
        }

        .fieldset {
            border: 1px solid darkblue;
            border-radius: 10px;
            padding: 10px;
            width: 45%;
            /* Adjust width as needed */
            display: inline-block;
            vertical-align: top;
            /* Align fieldsets side by side */
            margin-right: 10px;
            /* Add some space between the fieldsets */
            color: black;
            font-weight: normal;
            /* Reset any inherited bold styles */
        }

        .checkbox-grid-4-columns {
            display: grid;
            grid-template-columns: repeat(4, auto);
            /* Adjusted to 4 columns */
            gap: 10px;
        }

        .checkbox-grid-3-columns {
            display: grid;
            grid-template-columns: repeat(3, auto);
            /* Adjusted to 4 columns */
            gap: 10px;
        }

        .checkbox-grid-6-columns {
            display: grid;
            grid-template-columns: repeat(6, auto);
            /* Adjusted to 4 columns */
            gap: 10px;
        }

        .checkbox-grid-7-columns {
            display: grid;
            flex-wrap: wrap;
            grid-template-columns: repeat(7, auto);
            /* Adjusted to 4 columns */
            gap: 20px;
        }

        .checkbox-grid-12-columns {
            display: grid;
            grid-template-columns: repeat(18, auto);
            /* Adjusted to 4 columns */
            gap: 5px;
        }

        .checkbox-grid-8-columns {
            display: grid;
            grid-template-columns: repeat(8, auto);
            /* Adjusted to 8 columns */
            gap: 5px;
        }

        .checkbox-grid-2-columns {
            display: grid;
            grid-template-columns: repeat(2, auto);
            /* Adjusted to 2 columns */
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
        }

        .clear {
            clear: both;
        }

        legend {
            font-weight: bold;
            /* Make the legend text bold */
        }

        label {
            margin-left: 5px;
            font-size: 12px;
        }

        .grid-center {
            text-align: center;
            margin-top: 20px;
            /* Adjust the top margin as needed */
        }

        .submit-button {
            margin: 10px;
            /* Adjust the margin around the buttons as needed */
            padding: 15px 20px;
            /* Adjust the padding inside the buttons as needed */
            background-color: green;
            color: white;
            font-size: 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .reset-button {
            margin: 10px;
            /* Adjust the margin around the buttons as needed */
            padding: 15px 20px;
            /* Adjust the padding inside the buttons as needed */
            background-color: darkblue;
            color: white;
            font-size: 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .submit-button:hover,
        .reset-button:hover {
            background-color: #0056b3;
            /* Change the background color on hover */
        }

        .submit-button:hover,
        .reset-button:hover {
            background-color: #0056b3;
        }

        /* Toggle switch CSS */
        /* Toggle switch CSS */
        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            /* Adjust width as needed */
            height: 20px;
            /* Adjust height as needed */
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            /* Adjust height as needed */
            width: 16px;
            /* Adjust width as needed */
            left: 2px;
            /* Adjust left position as needed */
            bottom: 2px;
            /* Adjust bottom position as needed */
            background-color: white;
            transition: 0.4s;
        }

        input:checked+.slider {
            background-color: #2196F3;
        }

        input:checked+.slider:before {
            transform: translateX(20px);
            /* Adjust translate value as needed */
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 20px;
            /* Adjust border-radius as needed */
        }

        .slider.round:before {
            border-radius: 50%;
        }

        input[type="date"] {
            padding: 2px;
            font-size: 12px;
            border: 2px solid darkblue;
            border-radius: 4px;
        }

        /* Header line styling */
        .header-line {
            border: 0;
            height: 2px;
            /* Adjust height as needed */
            background: darkblue;
            /* Adjust color as needed */
            margin: 0;
            /* Remove default margin */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
            /* Add subtle shadow for highlight */
        }

        .tooltip {
            position: absolute;
            background-color: lightyellow;
            color: black;
            padding: 10px;
            border: 1px solid black;
            border-radius: 5px;
            max-width: auto;
            z-index: 9999;
            font-size: 14px;
            text-align: left;
            /* Align the content to the left */
            white-space: pre-line;
            /* Display content line by line */
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
            /* Add a subtle shadow */
        }

        .calendar-container {
            position: relative;
            display: inline-block;
        }

        .calendar {
            position: absolute;
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 10px;
            z-index: 1000;
            display: none;
        }

        /** Toggle Box - Example Emergency Request **/
        /* Toggle switch CSS */
        /* Toggle switch CSS */
        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            /* Adjust width as needed */
            height: 20px;
            /* Adjust height as needed */
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            /* Adjust height as needed */
            width: 16px;
            /* Adjust width as needed */
            left: 2px;
            /* Adjust left position as needed */
            bottom: 2px;
            /* Adjust bottom position as needed */
            background-color: white;
            transition: 0.4s;
        }

        input:checked+.slider {
            background-color: #2196F3;
        }

        input:checked+.slider:before {
            transform: translateX(20px);
            /* Adjust translate value as needed */
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 20px;
            /* Adjust border-radius as needed */
        }

        .slider.round:before {
            border-radius: 50%;
        }

        .blink {
            display: block;
        }

        .blink-text {
            animation: blinker 1s linear infinite;
        }

        @keyframes blinker {
            50% {
                opacity: 0;
            }
        }

        /* The Modal (background) */
        /* The Modal (background) */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 10%;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
        }

        /* Modal Content */
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            /* Adjust this value to position the modal higher */
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            border-radius: 10px;
            font-size: 12px;
        }

        /* Close Button */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        /* Table styles */
        /* Table styles */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        table,
        th,
        td {
            border: 1px solid black;
        }

        th,
        td {
            padding: 5px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .support-text {
            position: absolute;
            right: 30px;
            /* Adjust this value as needed */
            font-size: 12px;
            color: black;
            background-color: yellow;

            text-align: right;
            margin-top: -10px;
            /* Move the element slightly upward */
        }

        .support-text a {
            color: darkblue;
            text-decoration: none;
        }

        .support-text a:hover {
            text-decoration: underline;
        }

        .file-upload p {
            font-size: 12px;
            /* Set the font size to 12px (you can adjust this as needed) */
            width: 200px;
            /* Set a fixed width for the text container */
            overflow: hidden;
            /* Hide any overflow text */
            white-space: nowrap;
            /* Prevent text from wrapping */
            text-overflow: ellipsis;
            /* Show ellipsis (...) for overflow text */
            display: none;
            /* Initially hide the text container */
        }

        /* Hide the default checkbox with ID sox */
        /* Style the custom checkbox with ID sox */
        #sox {
            //outline: 2px solid red
        }

        #spi {
            //outline: 2px solid red
        }

        #workstream:disabled,
        #sub-workstream:disabled {
            //color: #808080; /* Grey out text color */
            //background-color: #f0f0f0; /* Grey out background color */
            color: black;
            /* Grey out text color */
            background-color: lightgrey;
            /* Grey out background color */
            pointer-events: none;
            /* Disable pointer events */
        }

        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            text-align: center;
        }

        .confirm-box {
            display: inline-block;
            background: white;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            margin: 20% auto;
            max-width: 80%;
        }

        .confirm-box button {
            margin: 0 10px;
            padding: 5px 10px;
            cursor: pointer;
        }

        .right {
            text-align: right;
        }

        /*
      #partialMigration + label::after {
      content: "✔";
      position: absolute;
      top: 2px;
      left: 2px;
      font-size: 10px;
      color: transparent;
      }
      #partialMigration {
      display: none;
      }
      #partialMigration + label {
      position: relative;
      padding-left: 22px;
      cursor: pointer;
      }
      #partialMigration + label::before {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
      width: 10px;
      height: 10px;
      border: 2px solid #333;
      background-color: lightgrey; /* Change this to the desired background color */
        /* } */
        #partialMigration:checked+label::before {
            background-color: white;
            /* Change this to the desired background color when checked */
        }

        .form-container {
            background-color: white;
            border: 1px solid lightgrey;
            border-radius: 5px;
            padding: 20px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            width: 100%;
            box-sizing: border-box;
        }

        .marquee-container {
            width: 100%;
            /* Ensures it uses the full width of the parent container */
            overflow: hidden;
            /* Hide overflow to prevent stretching */
            box-sizing: border-box;
            margin-top: 10px;
            display: flex;
            /* Use flexbox for layout */
            flex-direction: column;
            /* Arrange items one by one vertically */
            gap: 5px;
        }

        .marquee {
            white-space: nowrap;
            animation: marquee 30s linear infinite;
            /* Ensure animation is active */
            box-sizing: border-box;
            width: 100%;
            /* Each marquee takes half the container width */
            overflow: hidden;
            /* Ensure text doesn't overflow */
            padding: 10px;
            /* Add padding for better appearance */
            border: 2px solid black;
            /* Add a border to each marquee */
            gap: 30px;
        }

        .marquee-container:hover .marquee {
            animation-play-state: paused;
            /* Pause the animation on hover */
        }

        .marquee1 {
            background-color: yellow;
            /* Background color for the first marquee */
            color: red;
            /* Text color for the first marquee */
            text-align: left;
            /* Align text to the left */
            width: 100%;
        }

        .marquee2 {
            background-color: darkblue;
            /* Background color for the second marquee */
            color: white;
            /* Text color for the second marquee */
            text-align: left;
            /* Align text to the right */
            width: 100%;
        }

        @keyframes marquee {
            0% {
                transform: translateX(100%);
            }

            100% {
                transform: translateX(-100%);
            }
        }
    </style>
    <!-- Script For JSOM & Sharepoint Connection -->
    <script src=https://code.jquery.com/jquery-3.6.0.min.js></script>
    <script src="/_layouts/15/sp.runtime.js"></script>
    <script src="/_layouts/15/sp.js"></script>
    <script src="/_layouts/15/SP.RequestExecutor.js"></script>
    <script>
        var siteUrl = "/sites/HRREVMW/HRMW";

        var clientContext = new SP.ClientContext(siteUrl);

        var userCollection = clientContext.get_web().get_siteUsers();

        var names = [];



        function loadSiteUsers() {

            clientContext.load(userCollection);

            clientContext.executeQueryAsync(onLoadUsersSuccess, onQueryFailed);

        }



        function onLoadUsersSuccess() {

            var userEnumerator = userCollection.getEnumerator();



            while (userEnumerator.moveNext()) {

                var oUser = userEnumerator.get_current();

                names.push({

                    email: oUser.get_email(),

                    name: oUser.get_title()

                });

            }

        }



        function onQueryFailed(sender, args) {

            alert('Error: ' + args.get_message());

        }



        SP.SOD.executeFunc('sp.js', 'SP.ClientContext', loadSiteUsers);

    </script>
    <script>
        $(document).ready(function () {

            // Alert to verify document.ready function

            //            alert("Document is ready!");



            // Hide specific elements

            //            $("#s4-titlerow, #sideNavBox, #s4-ribbonrow, #suiteBar, #ms-cui-ribbonTopBars").hide();



            $("#s4-titlerow, #sideNavBox,#FordBar").hide();

            $(".s4-clust").hide();





            // Additional CSS styling

            //          $("#s4-titlerow, #sideNavBox").css("display", "none !important");



        });

    </script>
</head>

<body>
    <div class="container">
        <div class="form-container">
            <div class="header">
                <div class="header-left">
                    <!--img src=https://banner2.cleanpng.com/20180807/uaj/kisspng-ford-motor-company-brand-logo-product-auto-locks-door-ford-5b6a2d0e68f752.00806094153368500643.jpg alt="Ford Logo" class="logo"-->
                    <img src=https://banner2.cleanpng.com/20180501/oge/avdfg2es2.webp alt="Ford Logo" class="logo">
                </div>
                <div class="header-center">
                    HCMERP-HCM CICD Approval & Migration Form
                </div>
                <div class="header-right">
                    <div class="user-guide">
                        <a href=https://azureford.sharepoint.com/sites/HRREVMW/HRMW/_layouts/download.aspx?SourceUrl=https://azureford.sharepoint.com/sites/HRREVMW/HRMW/Operational%20Documents/CICD_DOCS/CICD_Automation_User_Guide.pdf?
                            target="_blank" title="Click Here If you need help !" style="color:blue;font-size: medium;">
                            Refer User-Guide </a>/
                        <a href=docx icon DOS_DONTS_HCM_Migration.docx target="_blank"
                            title="Click Here If you need help !" style="color:blue;font-size: medium;">
                            Do's & Dont's </a> /
                        <a href=mp4 icon CICD MIGRATION SAMPLE REQUEST-20241113 1322-1.mp4 target="_blank"
                            title="Watch Here If you need help !" style="color:blue;font-size: medium;">
                            Video </a>
                    </div>
                    <div class="download-button">
                        <a href=https://azureford.sharepoint.com/sites/HRREVMW/HRMW/_layouts/download.aspx?SourceUrl=https://azureford.sharepoint.com/sites/HRREVMW/HRMW/Operational%20Documents/CICD_DOCS/Migration_Template_CSV_Generator.xlsm?
                            target="_blank">
                            <button type="button">Download Migration Template</button>
                        </a>
                    </div>
                </div>
            </div>
            <div class="marquee-container">
                <div class="marquee1">
                    <marquee>
                        Download the updated macro |
                        For BIP Migration , provide .catalog files by archiving |
                        For path - If there is "/" in folder name add "\\" before "/"(eg : shared/Custom/Human Capital
                        Management/A\\/I)
                    </marquee>
                </div>
                <div class="marquee2">
                    &nbsp;&nbsp; PROD Auto-Migration enabled for Falcon, Data Avengers, Phoenix, Frontier, Core HR,Rec &
                    Talent , KD 42.<br>
                    &nbsp;&nbsp; Under monitoring between 9AM IST to 11PM IST for next couple of weeks. Use this form
                    for all environments migration
                </div>
            </div>
            <hr class="header-line">
            <br>
            <form id="hcm_form">
                <!-- Your existing form content goes here -->
                <div class="grid-container">
                    <!-- 1st Row -->
                    <div class="label">PDO <span class="indicator">*</span></div>
                    <div class="label">Workstream<span class="indicator"></span></div>
                    <div class="label">Sub-Workstream<span class="indicator">*</span></div>
                    <div class="label">Priority</div>
                    <div class="label">Category</div>
                    <div class="label">Release Iteration</div>
                    <div class="label">230 Doc or WO#</div>
                    <!-- 2nd Row -->
                    <select class="control" id="pdo" onchange="updateTargetSelect()">
                        <option value="">Select PDO</option>
                        <option value="corehr">Core HR</option>
                        <option value="falcon">Falcon</option>
                        <option value="blackbox">Data Avengers</option>
                        <option value="phoenix">Phoenix</option>
                        <option value="kdfourtytwo">KD42</option>
                        <option value="frontier">Frontier</option>
                        <option value="insights">Insights</option>
                        <option value="trex">T-Rex</option>
                        <option value="learning">Learning</option>
                        <option value="mustang">Mustang</option>
                        <option value="recruitment">Recruitment </option>
                        <option value="talent">Talent</option>
                        <option value="cardinals">Cardinals</option>
                        <option value="uspayrollsupport">US Payroll Support</option>
                        <option value="testpdo">Test PDO</option>
                    </select>
                    <select class="control" id="workstream" disabled>
                        <option value="">Select Workstream</option>
                        <option value="Integration">Integration</option>
                        <option value="DI_Dashboard">DI - Dashboard</option>
                        <option value="security">Security</option>
                        <option value="Reporting">Reporting</option>
                        <option value="WORKFORCE COMPENSATION">Workforce Compensation</option>
                        <option value="EU_Payroll">EU Payroll</option>
                        <option value="IAAAP">IAAAP</option>
                        <option value="Payroll_Modernization">Payroll Modernization</option>
                        <option value="Core HR">Core HR</option>
                        <option value="Recruitment">Recruitment</option>
                        <option value="Talent">Talent</option>
                        <option value="Learning">Learning</option>
                        <option value="uspayrollsupport">US Payroll Support</option>
                        <option value="testing_purpose">Testing Purpose</option>
                    </select>
                    <select class="control" id="sub-workstream" disabled>
                        <option value="">Select Sub-Workstream</option>
                        <option value="EU- PRL">EU- PRL</option>
                        <option value="EU - NPRL">EU - NPRL</option>
                        <option value="ROW - PRL">ROW - PRL</option>
                        <option value="ROW - NPRL">ROW - NPRL</option>
                        <option value="EU & ROW - NPRL - GLOBAL">EU & ROW - NPRL - GLOBAL</option>
                        <option value="UCH">UCH</option>
                        <option value="WORKFORCE COMPENSATION">WORKFORCE COMPENSATION</option>
                        <option value="US-PAYROLL">US-PAYROLL</option>
                        <option value="DI DASHBOARD">DI DASHBOARD</option>
                        <option value="PAYROLL MODERNIZATION">PAYROLL MODERNIZATION</option>
                        <option value="security">Security</option>
                        <option value="Reporting - EU">Reporting - EU</option>
                        <option value="Reporting - ROW">Reporting - ROW</option>
                        <option value="IAAAP">IAAAP</option>
                        <option value="IAAAP-ROW">IAAAP-ROW</option>
                        <option value="IAAAP-EU">IAAAP-EU</option>
                        <option value="IAAAP_REPORTS">IAAAP_REPORTS</option>
                        <option value="Core HR - Absence & Benefits">Core HR - Absence & Benefits</option>
                        <option value="CPO">CPO</option>
                        <option value="Talent">Talent</option>
                        <option value="Recruitment">Recruitment</option>
                        <option value="Learning">Learning</option>
                        <option value="uspayrollsupport">US Payroll Support</option>
                        <option value="testing_purpose">Testing Purpose</option>
                    </select>
                    <select class="control" id="prioritySelect">
                        <option value="Medium">Medium</option>
                        <option value="Critical">Critical</option>
                        <option value="High">High</option>
                        <option value="Low">Low</option>
                    </select>
                    <select class="control" id="categorySelect" onchange="handleMigrationSelection()">
                        <option value="category">Select Category</option>
                        <option value="New Requirements">New Requirements</option>
                        <option value="WO/CR or Enhancement">WO/CR or Enhancement</option>
                        <option value="Incident & Defect Fix">Incident & Defect Fix</option>
                        <option value="Prod Performance Fix">Prod Performance Fix</option>
                        <option value="POC or Innovation">POC or Innovation</option>
                        <option value="Major Enhancement - Bulk">Major Enhancement - Bulk</option>
                        <option value="Re-Migration">Re-Migration</option>
                    </select>
                    <!--input type="checkbox" class="control"-->
                    <input type="text" class="control" placeholder="Enter valid Iteration#" id="releaseiteration">
                    <input type="text" class="control" placeholder="Enter 230 Doc. ID /WO#" id="TWOTHIRTYID">
                    <!-- 3rd Row -->
                    <div class="label span-3">Title <span class="indicator">*</span>
                        <span id="title-char-count" style="float: right;">0/99</span>
                    </div>
                    <div class="label">Emergency Request</div>
                    <div class="label">Due Date & Time</div>
                    <div class="label">SOX Freeze?</div>
                    <div class="label">Sensitive PI Info?</div>
                    <!-- 4th Row -->
                    <input type="text" class="control span-3" style="width: 98%;"
                        placeholder="Title Format : <User_Story_ID> -  Interface / Report Name" id="title"
                        maxlength="99" oninput="updateTitleCharacterCount()"
                        title="Title should not exceeded to 99 chars">
                    <label class="switch">
                        <input type="checkbox" id="toggleSwitch" onchange="checkER();">
                        <span class="slider round"></span>
                    </label>
                    <div class="calendar-container">
                        <input type="text" id="datetime" placeholder="Select Date and Time">
                        <div class="calendar" id="calendar">
                            <input type="date" id="date">
                            <input type="time" id="time">
                            <button id="okBtn" onclick="checkMonth()">OK</button>
                        </div>
                    </div>
                    <div class="label">
                        <div style="display: flex; align-items: center;">
                            <input type="checkbox" id="sox" name="sox" value="SOX" onclick="soxCheck()"
                                onchange="checklistUpload('sox')" style="margin-right: 5px;">
                            <div class="file-upload" id="sox_upload" style="display:none">
                                <input type="file" id="sox_file" style="display: none;"
                                    onchange="displayFileName('sox_file','selectedSOXFileName')">
                                <button type="button" onclick="document.getElementById('sox_file').click();"
                                    style="background:green;font-size:11.7px">
                                    Attach SOX Approval
                                </button>
                                <p id="selectedSOXFileName"></p>
                            </div>
                        </div>
                    </div>
                    <div class="label">
                        <div style="display: flex; align-items: center;">
                            <input type="checkbox" id="spi" name="spi" value="spi" onclick="checkSPI()">
                            <div class="file-upload" id="spi_upload" style="display:none">
                                <input type="file" id="spi_file" style="display: none;"
                                    onchange="displayFileName('spi_file','selectedSPIFileName')">
                                <button type="button" onclick="document.getElementById('spi_file').click();"
                                    style="background:green;font-size:11.7px">
                                    Attach SPI/PI Info
                                </button>
                                <p id="selectedSPIFileName"></p>
                            </div>
                        </div>
                    </div>
                    <div class="label span-3">Description<span class="indicator">*</span></div>
                    <div class="label span-2">Remarks/Comments To Admin</div>
                    <div class="label">Manual Admin Support</div>
                    <div class="label"><label for="customer_poc">Customer POC</label>
                    </div>
                    <!-- 5th Row -->
                    <textarea id="description" class="control span-3" rows="5" style="width: 98%;"
                        placeholder="Give a detail description on Summary / Root Cause / Changes done"></textarea>
                    <textarea id="comments" class="control span-2" rows="5" style="width: 98%;"
                        placeholder="Migration Instructions to Admin"></textarea>
                    <div class="label">
                        <input type="checkbox" id="admin_run" name="admin_run" value="admin_run">
                    </div>
                    <div class="label">
                        <input type="text" class="control" id="customer_poc" name="customer_poc"
                            placeholder="Enter Valid  CDSID">
                    </div>
                    <!-- 6th Row -->
                    <!-- 6th Row -->
                </div>
                <div class="line-container">
                    <div class="short-line"></div>
                    <span class="line-text" id="migrationDetails">Migration Details</span>
                    <b>
                        <p id="ReMigrationText" style="color:red"></p>
                    </b>
                    <div class="long-line">

                    </div>
                    <div class="file-upload">
                        <input type="file" id="migrationFileInput" accept=".csv" style="display: none;"
                            onchange="displayFileName('migrationFileInput','selectedMigrationFileName'),validateFileType()">
                        <button type="button" onclick="document.getElementById('migrationFileInput').click();"
                            style="background:green;">
                            Upload CSV Migration Template
                        </button>
                        <p id="selectedMigrationFileName"></p>
                        <p id="errorMessage" style="color: red;"></p>
                    </div>
                </div>
                <div class="grid-container-8">
                    <!-- Column 1: Source Environment Label -->
                    <div class="control" style="border:none;font-size:12px;"> Source Instance <span
                            class="indicator">*</span></div>
                    <!-- Column 2: Source Environment Drop Down -->
                    <div class="label">
                        <select class="control" id="sourceSelect">
                            <option value="">Select</option>
                            <option value="sourceDev1">Dev1</option>
                            <option value="sourceDev2">Dev2</option>
                            <option value="sourceDev3">Dev3</option>
                            <option value="sourceDev4">Dev4</option>
                            <option value="sourceDev5">Dev5</option>
                            <option value="sourceDev9">Dev9</option>
                            <option value="sourceTest">TEST</option>
                            <option value="sourceDev15">Dev15</option>
                            <option value="sourceDev16">Dev16</option>
                            <option value="sourceDev17">Dev17</option>
                            <!--option value="sourcePROD">PROD</option-->
                            <!-- Add more options as needed -->
                        </select>
                    </div>
                    <!-- Column 3: Target Environment Label -->
                    <div class="control" style="border:none;font-size:12px;">Target Instance<span
                            class="indicator">*</span></div>
                    <!-- Column 4: Target Environment Drop Down -->
                    <div class="label">
                        <select class="control" id="targetSelect">
                            <option value="">Select</option>
                            <option value="targetPROD">PROD</option>
                            <option value="targetDev17">Dev17</option>
                            <option value="targetDev16">Dev16</option>
                            <option value="targetDev15">Dev15</option>
                            <option value="targetTEST">TEST</option>
                            <option value="targetDev9">Dev9</option>
                            <option value="targetDev5">Dev5</option>
                            <option value="targetDev4">Dev4</option>
                            <option value="targetDev3">Dev3</option>
                            <option value="targetDev2">Dev2</option>
                            <option value="targetDev1">Dev1</option>
                            <!-- Add more options as needed -->
                        </select>
                    </div>
                    <!-- Column 5: GitHub Commit ID & URL Label -->
                    <div class="control" style="border:none;font-size:12px;">GitHub Commit ID & URL <span
                            class="indicator" id="commitIndicator" style="display:none;">*</span></div>
                    <!-- Column 6: GitHub Commit ID Text Box -->
                    <div>
                        <input class="control" type="text" placeholder="Commit ID" id="githubCommitId">
                    </div>
                    <!--span class="indicator" id="githubUrlIndicator" style="display:none;">*</span-->
                    <!-- Column 7: GitHub URL Text Box -->
                    <div class="github-url">
                        <input type="text" placeholder="GitHub URL" class="control" id="githubURL">
                    </div>
                    <!-- Column 8: GitHub URL Text Box -->
                    <div class="control" style="border:none;font-size:12px;">GitHub Merge Status</div>
                    <div>
                        <input type="checkbox" id="githubmergestatus" name="githubmergestatus"
                            value="githubmergestatus">
                    </div>
                </div>
                <br>
                <div class="grid-container-custom">
                    <div class="control" class="label span-2" style="border:none;font-size:12px;">Assign To</div>
                    <div>
                        <input type="text" class="control span-2" style="width:95%;" id="assigned_to" name="assigned_to"
                            placeholder="DEFAULT ASSIGNEE - ABATHAM@FORD.COM">
                        <ul style="border:none" id="assignedtolist" class="control span-2" style="width: 98%;"></ul>
                    </div>
                    <div class="control label span-2" style="border:none;font-size:12px;">Manual Admin Activities</div>
                    <div>
                        <select class="control" id="manual_admin_activities" name="manual_admin_activities" multiple
                            style="width: 100%;">
                            <option value="admin_activity_none">None</option>
                            <option value="admin_activity_vbcs_migration">VBCS Migration</option>
                            <option value="admin_activity_page_personalization">Page Personalization</option>
                            <option value="admin_activity_config_changes">Configuration Changes</option>
                            <option value="admin_activity_query_running">Query Running</option>
                            <option value="admin_activity_data_extraction">Data Extraction</option>
                            <option value="admin_activity_scheduling">Scheduling Extracts/Reports/Processes</option>
                            <option value="admin_activity_sr_support">SR Support</option>
                            <option value="admin_activity_hdl_load">HDL/HSDL Load</option>
                            <option value="admin_activity_formula_compilation">Fast Formula Compilation</option>
                            <option value="admin_activity_dashboard_config">Dashboard Configuration</option>
                            <option value="admin_activity_paas_activity">PAAS Related Activity</option>
                            <option value="admin_activity_adhoc_activity">Adhoc Admin Activity</option>
                            <option value="admin_activity_big_file_size_migration">Manual Migration If file size is huge
                            </option>
                            <option value="admin_activity_bi_admin">BI Administration</option>
                            <!-- Add more options as needed -->
                        </select>
                        <!-- Removed the unordered list as it's not needed for a dropdown -->
                    </div>
                    <div class="control" id="low_sp_id_label" style="border:none;font-size:12px;">Test Migration ID
                    </div>
                    <div>
                        <input type="text" id="low_sp_id_textbox" name="sp_id" placeholder="TEST Migration SP ID"
                            class="control">
                    </div>
                </div>
                <!--div class="line-container">
            <div class="short-line"></div>
           
            <span class="line-text" id="toggleText">Additional Migration Details <span id="arrowIcon">&#9660;</span></span>
           
            <div class="long-line"></div>
           
            </div>
           
            <div id="additional_migration_details" style="display: none;">
           
            <div class="checkbox-grid-4-columns">
           
                ------------------------------------------------------------------------ ADDITIONAL MIGRATION DETAILS CONTENT HERE -------------------------------------------------------------------------------------
           
           
           
           
           
            </div>
           
            </div-->
                <div class="line-container">
                    <div class="short-line"></div>
                    <span class="line-text">Migration Scope</span>
                    <b>
                        <p id="MigrationText" style="color:purple;"></p>
                    </b>
                    <div class="long-line"></div>
                </div>
                <!-- Additional fieldsets and form elements -->
                <!-- Migration Scope fieldset -->
                <!--fieldset class="fieldset" style="width:94%">
            <legend>Migration Scope</legend-->
                <div class="checkbox-grid-8-columns">
                    <div class="checkbox-item">
                        <input type="checkbox" id="bip" name="bip" value="BI PUBLISHER">
                        <label for="bip">BIP</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="lookup" name="lookup" value="LOOKUP">
                        <label for="lookup">Lookup</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="valueset" name="valueset" value="VALUESET" onclick="valuesetcheck()">
                        <label for="valueset">Valueset</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="fast-formula" name="fast-formula" value="FAST FORMULA">
                        <label for="fast-formula">Fast Formula</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="hcm-extract" name="hcm-extract" value="HCM EXTRACT">
                        <label for="hcm-extract">HCM Extract</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="payroll-flow" name="payroll-flow" value="PAYROLL FLOW">
                        <label for="payroll-flow">Payroll Flow</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="udt" name="udt" value="USER-DEFINED TABLE (UDT)">
                        <label for="udt">UDT</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="otbi" name="otbi" value="OTBI Analysis">
                        <label for="otbi">OTBI Analysis</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cwbUpdate" name="cwb-update" value="CWB Update">
                        <label id="manual" for="cwbUpdate">CWB Update</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="balanceGroups" name="balanceGroups" value="BALANCE GROUPS">
                        <label id="manual" for="balanceGroups">Balance Groups</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="balanceGroupsUsages" name="balanceGroupsUsages"
                            value="BALANCE GROUP USAGES">
                        <label id="manual" for="balanceGroupsUsages">Balance Groups Usages</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="hdlDataFix" name="hdlDataFix" value="HDL Data Fix">
                        <label id="manual" for="hdlDataFix">HDL Data Fix</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="manualMigration" name="cwb-update" value="Manual Migration"
                            style="outline:2px solid red;">
                        <label id="manualMigrationText" class="blink" style="color:red;">Manual Migration</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="partialMigration" name="partialMigration" value="partialMigration"
                            style="background-color: Red;" disabled>
                        <label id="partialMigrationText" class="blink">Partial Migration</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="uncheck_all" name="uncheck_all" value="uncheck_all"
                            onclick="handleUncheckAll()">
                        <label id="uncheck_all_lbl" class="blink">Uncheck All</label>
                    </div>
                    <div class="checkbox-item hidden" id="HtoLContainer">
                        <input type="checkbox" id="HtoL" name="HtoL" value="HtoL" onclick="handleHtoL()" checked
                            disabled style="display:none;">
                        <div class="green-checkbox"></div>
                        <label id="HtoL_lbl" class="green-label green-checkbox-label">HtoL</label>
                    </div>
                    <div class="checkbox-item hidden">
                        <label for="bip_security_views_dropdown" style="margin-right: 10px;">Security Views</label>
                        <select id="bip_security_views_dropdown" name="bip_security_views_dropdown" class="control">
                            <option value="" disabled selected>Select</option> <!-- Placeholder option -->x
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="NA">NA</option>
                        </select>
                    </div>
                    <div class="checkbox-item hidden">
                        <!--input type="checkbox" id="bip_role_review" name="bip_role_review" value="bip_role_review"-->
                        <label id="bip_role_review_dropdown" style="margin-right: 10px;">Role to reporting
                            Permission</label>
                        <select id="bip_role_review_dropdown" name="bip_role_review_dropdown" class="control">
                            <option value="" disabled selected>Select</option> <!-- Placeholder option -->
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="NA">NA</option>
                        </select>
                    </div>
                </div>
                <!--/fieldset-->
                <!--/fieldset-->
                <div class="line-container">
                    <div class="short-line"></div>
                    <span class="line-text" id="checklisttoggleText">Migration Checklist<span
                            class="checklistarrow">&#9660;</span></span>
                    <div class="long-line"></div>
                </div>
                <div id="checklist" style="display:none">
                    <div class="checkbox-grid-7-columns">
                        <div class="checkbox-item">
                            <input type="checkbox" id="begin_development" name="begin-development"
                                value="Begin Development Approval"
                                onchange="checklistUpload('begin_development','yes')">
                            <label for="begin_development">Begin Development /Roll Back Plan</label>
                            <div class="file-upload" id="begin_development_upload" style="display:none;">
                                <input type="file" id="begin_development_file" style="display: none;"
                                    onchange="displayFileName('begin_development_file', 'selectedBeginDevelopmentFileName')">
                                <button type="button"
                                    onclick="document.getElementById('begin_development_file').click()"
                                    style="background:green;">Attach Begin Development</button>
                                <p id="selectedBeginDevelopmentFileName"></p>
                            </div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="unit_test" name="unit-test-completed"
                                value="Unit Test Completed ?" onchange="checklistUpload('unit_test')">
                            <label for="unit_test">Unit Test Completed ?</label>
                            <div class="file-upload" id="unit_test_upload" style="display:none;">
                                <input type="file" id="unit_test_file" style="display: none;"
                                    onchange="displayFileName('unit_test_file', 'selectedUnitTestFileName')">
                                <button type="button" onclick="document.getElementById('unit_test_file').click()"
                                    style="background:green;">Attach Unit Test</button>
                                <p id="selectedUnitTestFileName"></p>
                            </div>
                        </div>
                        <!-- Add more checkbox-item divs for other checkboxes -->
                        <div class="checkbox-item">
                            <input type="checkbox" id="code_review" name="code_review" value="code_review"
                                onchange="checklistUpload('code_review')">
                            <label for="code_review">Code Review ?</label>
                            <div class="file-upload" id="code_review_upload" style="display:none;">
                                <input type="file" id="code_review_file" style="display: none;"
                                    onchange="displayFileName('code_review_file', 'selectedCodeReview')">
                                <button type="button" onclick="document.getElementById('code_review_file').click()"
                                    style="background:green;">Attach Code Review</button>
                                <p id="selectedCodeReview"></p>
                            </div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sit_uat" name="sit_uat" value="sit_uatl"
                                onchange="checklistUpload('sit_uat')">
                            <label for="sit_uat">SIT/UAT Approval</label>
                            <div class="file-upload" id="sit_uat_upload" style="display:none;">
                                <input type="file" id="sit_uat_file" style="display: none;"
                                    onchange="displayFileName('sit_uat_file', 'selectedSITUATFileName')">
                                <button type="button" onclick="document.getElementById('sit_uat_file').click()"
                                    style="background:green;">Attach SIT/UAT Approval</button>
                                <p id="selectedSITUATFileName"></p>
                            </div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="all_checklist" name="all_checklist" value="all_checklist"
                                onchange="checklistAll()">
                            <label for="all_checklist">All</label>
                        </div>
                    </div>
                    <br>
                    <div class="grid-container-four">
                        <div class="checkbox-item">
                            <input type="checkbox" id="mig_config" name="mig_config" value="mig_config"
                                onchange="checklistUpload('mig_config')">
                            <label for="mig_config" class="span-4" style="width:200px;">Migration/Configuration
                                Document</label>
                            <div class="file-upload" id="mig_config_upload" style="display:none;">
                                <input type="file" id="mig_config_file" style="display: none;"
                                    onchange="displayFileName('mig_config_file', 'selectedmigconfigFileName')">
                                <button type="button" onclick="document.getElementById('mig_config_file').click()"
                                    style="background:green;">Attach Migration/Configuration Approval</button>
                                <p id="selectedmigconfigFileName"></p>
                            </div>
                        </div>
                        <label class="label">Others</label>
                        <input type="text" placeholder="SharePoint URL" style="width:15%;" class="control span-2">
                        <label class="label" id="lbl_sox_sp_url" style="display:none;">SOX SP URL</label>
                        <input type="text" id="txt_box_sox_sp_url" placeholder="SharePoint URL"
                            style="width:15%;display:none" class="control span-2" style="display:none;">
                        <label class="label" id="lbl_spi_sp_url" style="display:none;">SPI SP URL</label>
                        <input type="text" id="txt_box_spi_sp_url" placeholder="SharePoint URL"
                            style="width:15%;display:none" class="control span-2" style="display:none;">
                    </div>
                </div>
                <div class="line-container">
                    <div class="short-line"></div>
                    <span class="line-text" id="backuptoggleText">Backup Approver Configuration<span
                            class="backuparrow">&#9660;</span></span>
                    <div class="long-line"></div>
                    <button type="button"
                        style="background:gray;color:white;border-radius: 5px;cursor: pointer;font-size:15px"
                        onclick="openModal()">
                        List Of Default Approvers
                    </button>
                </div>
                <div id="backup" style="display:none">
                    <div class="grid-container-eight">
                        <div class="label span-2">Tech Lead / PDO Manager - Backup Approver</div>
                        <div class="label span-2">ROW Business Owner - Backup Approver</div>
                        <div class="label span-2">EU Business Owner - Backup Approver</div>
                        <div class="label span-2">IT Owner / Product Owner - Backup Approver</div>
                        <input type="text" class="control span-2" style="width: 98%;"
                            placeholder="Select Backup TL Approver" id="BackupTechLeadApprover">
                        <input type="text" class="control span-2" style="width: 98%;"
                            placeholder="Select Backup ROW BO Approver" id="BackupBOApproverROW">
                        <input type="text" class="control span-2" style="width: 98%;"
                            placeholder="Select Backup EU BO Approver" id="BackupBOApproverEU">
                        <input type="text" class="control span-2" style="width: 98%;"
                            placeholder="Select Backup IT Owner Approver" id="BackupITOwnerApprover">
                        <ul id="backUpTlList" class="control span-2" style="width: 98%;"></ul>
                        <ul id="backUpROWList" class="control span-2" style="width: 98%;"></ul>
                        <ul id="backUpEUList" class="control span-2" style="width: 98%;"></ul>
                        <ul id="backUpITList" class="control span-2" style="width: 98%;"></ul>
                    </div>
                </div>
                <!-- Submit and Reset buttons -->
                <div class="grid-center">
                    <button type="submit" class="submit-button" onclick="createItem(event);">Submit</button>
                    <button type="reset" class="reset-button" onclick="resetForm()">Reset</button>
                    <input type="hidden" id="__REQUESTDIGEST" value="<%= SPContext.Current.FormDigestValue %>" />
                </div>
                <footer>
                    <!--div class="left">Developed by Your Name</div-->
                    <div class="right" style="font-size:15px;color:darkblue;font-family:Helvetica Neue">
                        For any inquiries - <b>hcm_hrmw_cicd_support@bulkmail.ford.com</b>
                        <div class="support-text"
                            style="font-size:12px;color:black;background-color:yellow;padding:5px;margin-top:5px;display:none;">
                            For additional support, contact <a href="mailto:support@ford.com"
                                style="color:darkblue;text-decoration:none;">support@ford.com</a>.
                        </div>
                    </div>


                </footer>
        </div>
    </div>
    </form>
    <!-- Modal Content -->
    <!-- The Modal -->
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 style="color:darkblue">Default Approvers List For HCM Migration</h2>
            <table>
                <thead>
                    <tr>
                        <th>PDO</th>
                        <th>TL Approvers</th>
                        <th>ROW-BO Approvers</th>
                        <th>Additional ROW-BO Approvers</th>
                        <th>EU-BO Approvers</th>
                        <th>Additional EU-BO Approvers</th>
                        <th>IT Owner</th>
                        <th>Additional IT Owner</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><b>Falcon</b></td>
                        <td>Shanmuga sundaram, Uma Mag (U.); Balaji, Nagarajan (N.); Ponnusamy, Sumathi (S.);
                            Jagadeesan, Arun (J.); Rajakumar, Dineshkumar (D.); Ramamoorthy, Karthikeyan (K.)</td>
                        <td>Mikonczyk, Mickey (M.C.)</td>
                        <td>N/A</td>
                        <td>Samtlebe, Florian (F.)</td>
                        <td>N/A</td>
                        <td>Venkatesh, PS (PS); Eichhardt, Michael (M.); Eben, Shiny (R)</td>
                        <td>Jagadeesan, Arun (J.)</td>
                    </tr>
                    <tr>
                        <td><b>Data Avengers</b></td>
                        <td>Shanmuga sundaram, Uma Mag (U.); Balaji, Nagarajan (N.); Ponnusamy, Sumathi (S.);
                            Jagadeesan, Arun (J.); Rajakumar, Dineshkumar (D.); Ramamoorthy, Karthikeyan (K.)</td>
                        <td>Mikonczyk, Mickey (M.C.)</td>
                        <td>N/A</td>
                        <td>Samtlebe, Florian (F.)</td>
                        <td>N/A</td>
                        <td>Venkatesh, PS (PS); Eichhardt, Michael (M.); Eben, Shiny (R)</td>
                        <td>Jagadeesan, Arun (J.)</td>
                    </tr>
                    <tr>
                        <td><b>Phoenix</b></td>
                        <td> Rajakumar, Dineshkumar (D.)</td>
                        <td>Mikonczyk, Mickey (M.C.)</td>
                        <td>N/A</td>
                        <td>Samtlebe, Florian (F.)</td>
                        <td>N/A</td>
                        <td>Venkatesh, PS (PS); Eichhardt, Michael (M.); Eben, Shiny (R)</td>
                        <td>N/A</td>
                    </tr>
                    <tr>
                        <td><b>KD42</b></td>
                        <td>Otte, Sven (S.); Rode, Kai (K.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>Samtlebe, Florian (F.)</td>
                        <td>Gardner, Keeley (K.)</td>
                        <td>Michael Eichhardt (M.); Albers, Wolfgang (W.)</td>
                        <td>N/A</td>
                    </tr>
                    <tr>
                        <td><b>Insights</b></td>
                        <td>Mulla, Noor Samad (N.); Thiagarajan, Viswanath (V.A.)</td>
                        <td>Juliet, Merlin (J.); Scally, Patrick (P.)</td>
                        <td>N/A</td>
                        <td>Samtlebe, Florian (F.)</td>
                        <td>Gardner, Keeley (K.)</td>
                        <td>Murugan, Vairamoorthy (M.); Thiagarajan, Viswanath (V.A.); Michael Eichhardt (M.)</td>
                        <td>Ch, Sakthivel (C.)</td>
                    </tr>
                    <tr>
                        <td><b>Frontier</b></td>
                        <td>Ch, Sakthivel (C.); Avalapati, Padmaja (P.)</td>
                        <td>Juliet, Merlin (J.); Scally, Patrick (P.)</td>
                        <td>N/A</td>
                        <td>Samtlebe, Florian (F.)</td>
                        <td>Gardner, Keeley (K.)</td>
                        <td>Michael Eichhardt (M.); Murugan, Vairamoorthy (M.)</td>
                        <td>Ch, Sakthivel (C.)</td>
                    </tr>
                    <tr>
                        <td><b>Core HR</b></td>
                        <td>Tilwankar, Shashank (S.); Vundavalli, Sudha (S.)</td>
                        <td>Murugan, Vairamoorthy (M.); Mikonczyk, Mickey (M.C.); Mufhadi, Jennifer (J.T.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>Shanmugam, Prakash (S.); Vundavalli, Sudha (S.)</td>
                        <td>N/A</td>
                    </tr>
                    <tr>
                        <td><b>Learning</b></td>
                        <td>Akula, Veerabhadraiah (V.); Katkoju, Sampath Kumar (S.); S B, Tabita Percy (S B)</td>
                        <td>Szafranski, Kelly (K.A.); Faith, Stephanie (S.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>A, Lavanya (A.); S B, Tabita Percy (S B)</td>
                        <td>Shanmugam, Prakash (S.)</td>
                    </tr>
                    <tr>
                        <td><b>Mustang</b></td>
                        <td>Balaramakrishnan, Manimaran (B.); A, Lavanya (A.)</td>
                        <td>Erickson, Yolanda (Y.)</td>
                        <td>Lind, Marsha (L.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>A, Lavanya (A.)</td>
                        <td>Shanmugam, Prakash (S.)</td>
                    </tr>
                    <tr>
                        <td><b>Talent<b></td>
                        <td>Gajendran, Jagadeesh (.)</td>
                        <td>Szafranski, Kelly (K.A.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>Racano, Eleanor (E.)</td>
                        <td>N/A</td>
                    </tr>
                    <tr>
                        <td><b>Recruitment</b></td>
                        <td>Gajendran, Jagadeesh (.)</td>
                        <td>Tomonaga, Joleen (J.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>Racano, Eleanor (E.)</td>
                        <td>N/A</td>
                    </tr>
                    <tr>
                        <td><b>US Payroll Support</b></td>
                        <td>Balaramakrishnan, Manimaran (B.); Nyshadham, Srinivas (S.)</td>
                        <td>Sarraf, Doreen (D.A.)</td>
                        <td>Keller, Mary (M.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>Peters, James (Paul.)</td>
                        <td>Suyak, Lisa (L.K.)</td>
                    </tr>
                    <tr>
                        <td><b>T-Rex</b></td>
                        <td>Albers, Wolfgang (W.)</td>
                        <td>Mikonczyk, Mickey (M.C.),Mufhadi, Jennifer (J.T.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>Venkatesh, PS (PS); Eben, Shiny (R)</td>
                        <td>Ponnusami, Pravin Chander (P.)</td>
                    </tr>
                    <tr>
                        <td><b>Cardinals</b></td>
                        <td>Karthicsah, Thirumalli Punjusah (T.); Solaimalai, Om Prabhu (O.)</td>
                        <td>Mikonczyk, Mickey (M.C.)</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>N/A</td>
                        <td>Devanand, V (V.); Varshan, Jahannath (R)</td>
                        <td>N/A</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <!-- End > Modal Content -->
    <!-- Confirm Light Box Effect -->
    <div class="lightbox" id="confirmBox" style="display:none">
        <div class="confirm-box">
            <p id="confirmMessage"></p>
            <button id="yesButton">Yes</button>
            <button id="noButton">No</button>
        </div>
    </div>
    <!-- Confirm Light box ends -->
    <!--script>
      document.getElementById('toggleText').addEventListener('click', function() {
     
      var details = document.getElementById('additional_migration_details');
     
      var arrowIcon = document.getElementById('arrowIcon');
     
     
     
      if (details.style.display === 'none') {
     
      details.style.display = 'block';
     
      arrowIcon.innerHTML = '&#9650;'; // Up arrow
     
      } else {
     
      details.style.display = 'none';
     
      arrowIcon.innerHTML = '&#9660;'; // Down arrow
     
      }
     
      });
     
      document.getElementById('toggleTextchecklist').addEventListener('click', function() {
     
      var details = document.getElementById('checklist');
     
      var arrowIcon = document.getElementById('arrowIcon');
     
     
     
      if (details.style.display === 'none') {
     
      details.style.display = 'block';
     
      arrowIcon.innerHTML = '&#9650;'; // Up arrow
     
      } else {
     
      details.style.display = 'none';
     
      arrowIcon.innerHTML = '&#9660;'; // Down arrow
     
      }
     
      });
     
      </script-->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Get references to the checkboxes and dropdown
            const bipCheckbox = document.getElementById("bip");
            const bipSecurityViewsDropdown = document.getElementById("bip_security_views_dropdown");
            const bipRoleReviewCheckbox = document.getElementById("bip_role_review_dropdown");

            // Function to show/hide dependent elements
            function toggleDependentElements() {
                if (bipCheckbox.checked) {
                    // Show and enable the dependent elements
                    bipSecurityViewsDropdown.parentElement.classList.remove("hidden");
                    bipSecurityViewsDropdown.disabled = false;

                    bipRoleReviewCheckbox.parentElement.classList.remove("hidden");
                    bipRoleReviewCheckbox.disabled = false;
                } else {
                    // Hide and disable the dependent elements
                    bipSecurityViewsDropdown.parentElement.classList.add("hidden");
                    bipSecurityViewsDropdown.disabled = true;
                    bipSecurityViewsDropdown.value = ""; // Reset dropdown value

                    bipRoleReviewCheckbox.parentElement.classList.add("hidden");
                    bipRoleReviewCheckbox.disabled = true;
                    bipRoleReviewCheckbox.checked = false; // Uncheck if it was checked
                }
            }

            // Add event listener for manual changes to the BIP checkbox
            bipCheckbox.addEventListener("change", toggleDependentElements);

            // Automatically check BIP and show dependent elements when a specific PDO is selected
            const pdoDropdown = document.getElementById("pdo");
            pdoDropdown.addEventListener("change", function () {
                const selectedPDO = pdoDropdown.value;

                // Example: Automatically check BIP for specific PDOs
                const autoCheckPDOs = ["corehr", "falcon", "blackbox"]; // Add PDOs as needed
                if (autoCheckPDOs.includes(selectedPDO)) {
                    bipCheckbox.checked = true;
                    toggleDependentElements(); // Ensure dependent elements are displayed
                } else {
                    bipCheckbox.checked = false;
                    toggleDependentElements(); // Ensure dependent elements are hidden
                }
            });

            // Initial call to set the state correctly on page load
            toggleDependentElements();
        });
    </script>
    <Script>
        function toggleSection(sectionId, arrowIconId) {

            var section = document.getElementById(sectionId);

            var arrowIcon = document.getElementById(arrowIconId);

            //alert(section.style.display);

            if (section.style.display === 'none') {



                section.style.display = 'block';

                arrowIcon.innerHTML = '&#9650;'; // Up arrow

            } else {



                section.style.display = 'none';

                arrowIcon.innerHTML = '&#9660;'; // Down arrow

            }

        }

        document.getElementById('checklisttoggleText').addEventListener('click', function () {

            toggleSection('checklist', 'checklistarrow');

        });



        document.getElementById('backuptoggleText').addEventListener('click', function () {

            toggleSection('backup', 'backuparrow');

        });

    </script>
    <script>
        const tooltips = {

            sourceSelect: `DEV2  - https://efds-dev2.fa.em5.oraclecloud.com/
     
      DEV5  - https://efds-dev5.fa.em5.oraclecloud.com/
     
      DEV16 - https://fa-efds-dev16-saasfaprod1.fa.ocs.oraclecloud.com/fscmUI/faces/FuseWelcome
     
      DEV17 - https://login-efds-dev17-saasfaprod1.fa.ocs.oraclecloud.com/
     
      TEST  - https://efds-test.fa.em5.oraclecloud.com/`,

            targetSelect: `TEST  - https://efds-test.fa.em5.oraclecloud.com/
     
      DEV17 - https://login-efds-dev17-saasfaprod1.fa.ocs.oraclecloud.com/
     
      DEV16 - https://fa-efds-dev16-saasfaprod1.fa.ocs.oraclecloud.com/fscmUI/faces/FuseWelcome
     
      DEV5  - https://efds-dev5.fa.em5.oraclecloud.com/
     
      DEV2  - https://efds-dev2.fa.em5.oraclecloud.com/`,

            description: 'The description should be clear and informative, summarizing any changes made or explaining the root cause',

            title: 'Enter correct title as per the standard\neg: <User Story_ID> - Interface / Report Name',

            TWOTHIRTYID: 'Enter Valid 230 SP_ID Or workorder No. Or Incident No.',

            sox: 'Check this box if there is a financial impact or SOX freeze.',

            spi: 'Is any restricted, sensitive, or personal identifiable information (PII) attached?',

            admin_run: `HCM Job Schedule and Un-Schedule.
     
          Production - Issue Analysis` ,

            low_sp_id_textbox: 'Enter the TEST Migration SP ID ',

        };



        function showTooltip(field, event) {

            const tooltip = document.createElement('div');

            tooltip.className = 'tooltip';

            tooltip.textContent = tooltips[field];

            tooltip.style.top = `${event.clientY}px`;

            tooltip.style.left = `${event.clientX}px`;

            document.body.appendChild(tooltip);

        }



        function hideTooltip() {

            const tooltip = document.querySelector('.tooltip');

            if (tooltip) {

                tooltip.remove();

            }

        }



        document.getElementById('sourceSelect').addEventListener('mouseover', (event) => showTooltip('sourceSelect', event));

        document.getElementById('sourceSelect').addEventListener('mouseout', hideTooltip);



        document.getElementById('targetSelect').addEventListener('mouseover', (event) => showTooltip('targetSelect', event));

        document.getElementById('targetSelect').addEventListener('mouseout', hideTooltip);



        document.getElementById('description').addEventListener('mouseover', (event) => showTooltip('description', event));

        document.getElementById('description').addEventListener('mouseout', hideTooltip);



        document.getElementById('title').addEventListener('mouseover', (event) => showTooltip('title', event));

        document.getElementById('title').addEventListener('mouseout', hideTooltip);



        document.getElementById('TWOTHIRTYID').addEventListener('mouseover', (event) => showTooltip('TWOTHIRTYID', event));

        document.getElementById('TWOTHIRTYID').addEventListener('mouseout', hideTooltip);



        document.getElementById('sox').addEventListener('mouseover', (event) => showTooltip('sox', event));

        document.getElementById('sox').addEventListener('mouseout', hideTooltip);



        document.getElementById('spi').addEventListener('mouseover', (event) => showTooltip('spi', event));

        document.getElementById('spi').addEventListener('mouseout', hideTooltip);



        document.getElementById('admin_run').addEventListener('mouseover', (event) => showTooltip('admin_run', event));

        document.getElementById('admin_run').addEventListener('mouseout', hideTooltip);

        document.getElementById('low_sp_id_textbox').addEventListener('mouseover', (event) => showTooltip('low_sp_id_textbox', event));

        document.getElementById('low_sp_id_textbox').addEventListener('mouseout', hideTooltip);




    </script>
    <script>
        const calendarContainer = document.querySelector('.calendar-container');

        const calendar = document.querySelector('.calendar');

        const datetimeInput = document.getElementById('datetime');

        const dateInput = document.getElementById('date');

        const timeInput = document.getElementById('time');

        const okBtn = document.getElementById('okBtn');



        datetimeInput.addEventListener('focus', function () {

            calendar.style.display = 'block';

        });



        okBtn.addEventListener('click', function (event) {

            event.preventDefault(); // Prevent the form from submitting

            const selectedDate = dateInput.value;

            const selectedTime = timeInput.value;

            const dateTime = `${selectedDate} ${selectedTime}`;

            datetimeInput.value = dateTime;

            calendar.style.display = 'none';

        });



        document.addEventListener('click', function (event) {

            if (!calendarContainer.contains(event.target)) {

                calendar.style.display = 'none';

            }

        });

    </script>
    <script>
        function valuesetcheck() {



            var valuesetCheckbox = document.getElementById("valueset");

            var admin_run_checkbox1 = document.getElementById("admin_run");

            var partialMigrationCheckbox = document.getElementById("partialMigration");

            var partialMigrationText = document.getElementById('partialMigrationText');





            admin_run_checkbox1.checked = true;

            if (valuesetCheckbox.checked) {



                blinkText(partialMigrationText);

                partialMigrationCheckbox.disabled = false;

                partialMigrationCheckbox.checked = true;

                partialMigrationCheckbox.disabled = true;

                admin_run_checkbox1.checked = true;

                //partialMigrationCheckbox.style.outline = "2px solid orange";

                partialMigrationText.style.color = "orange";

            }

            else {

                partialMigrationCheckbox.checked = false;

                admin_run_checkbox1.checked = false;

            }
        }

        const manualMigrationCheckbox = document.getElementById('manualMigration');

        const adminRunCheckbox = document.getElementById('admin_run');

        const checkboxes = [

            document.getElementById('cwbUpdate'),

            document.getElementById('balanceGroups'),

            document.getElementById('balanceGroupsUsages'),

            document.getElementById('hdlDataFix')

        ];



        const blinkText = (textElement) => {

            //alert("Test");

            textElement.classList.add('blink-text');

            setTimeout(() => {

                textElement.classList.remove('blink-text');

            }, 5000);

        };



        const updateMigration = () => {

            const isChecked = checkboxes.some(checkbox => checkbox.checked);

            if (isChecked) {

                manualMigrationCheckbox.checked = true;

                adminRunCheckbox.checked = true;

                blinkText(manualMigrationCheckbox);

            } else {

                manualMigrationCheckbox.checked = false;

                adminRunCheckbox.checked = false;

            }

        };



        // Ensure adminRunCheckbox is checked whenever manualMigrationCheckbox is checked

        manualMigrationCheckbox.addEventListener('change', () => {

            if (manualMigrationCheckbox.checked) {

                adminRunCheckbox.checked = true;

            } else {

                adminRunCheckbox.checked = false;

            }

        });



        checkboxes.forEach(checkbox => {

            checkbox.addEventListener('change', updateMigration);

        });



        // Initial call to set the state correctly on page load

        updateMigration();



    </script>
    <script>
        // Get the modal

        var modal = document.getElementById("myModal");



        // Open the modal

        function openModal() {

            modal.style.display = "block";

        }



        // Close the modal

        function closeModal() {

            modal.style.display = "none";

        }



        // Close the modal when clicking anywhere outside of it

        window.onclick = function (event) {

            if (event.target == modal) {

                modal.style.display = "none";

            }

        }



    </script>
    <script>
        function updateTitleCharacterCount() {

            const titleInput = document.getElementById('title');

            const charCountSpan = document.getElementById('title-char-count');

            charCountSpan.textContent = `${titleInput.value.length}/99`;

        }

    </script>
    <script>
        function displayFileName(inputId, textId) {

            var fileInput = document.getElementById(inputId);

            var selectedFileName = document.getElementById(textId);



            if (fileInput.files.length > 0) {

                selectedFileName.textContent = fileInput.files[0].name;

                selectedFileName.style.display = "inline"; // Show the text container

            } else {

                selectedFileName.textContent = ""; // Clear the text if no file is selected

                selectedFileName.style.display = "none"; // Hide the text container

            }

        }

    </script>
    <script>
        document.getElementById('downloadButton').addEventListener('click', function () {

            // Replace 'YOUR_SHAREPOINT_FILE_URL' with the actual URL of your SharePoint file

            var url = 'https://azureford.sharepoint.com/sites/HRREVMW/HRMW/Operational%20Documents/HCMERP_Migration/HCM_HRCS/HRCS%20Position%20Interfaces%20-%20Migration%20Form_V1.xlsx?d=wcff0a8961d644124a749d3fdc67c1186';



            // Create a temporary anchor element

            var tempLink = document.createElement('a');



            // Set the href to the SharePoint file URL

            tempLink.href = url;



            // Set the download attribute to specify the filename

            tempLink.download = 'filename.ext'; // Change 'filename.ext' to your desired filename



            // Append the anchor to the body

            document.body.appendChild(tempLink);



            // Programmatically click the anchor to start the download

            tempLink.click();



            // Remove the anchor from the body

            document.body.removeChild(tempLink);

        });

    </script>
    <script>
        function soxCheck() {

            var soxCheckbox = document.getElementById('sox');

            var lbl_sox_sp = document.getElementById('lbl_sox_sp_url');

            var txt_box_sox_sp = document.getElementById('txt_box_sox_sp_url');

            if (soxCheckbox.checked == true) {

                soxCheckbox.style.outline = '2px solid red';

                lbl_sox_sp.style.display = "block";

                txt_box_sox_sp.style.display = "block";

                openMigrationChecklist("OPEN");

            }

            else {

                soxCheckbox.style.outline = '0px solid darkblue';

                lbl_sox_sp.style.display = "none";

                txt_box_sox_sp.style.display = "none";

                openMigrationChecklist("CLOSE");

            }

        }




    </script>
    <script>
        document.getElementById("hdlDataFix").addEventListener('change', handleHdlDataFixChange);

        document.getElementById("pdo").addEventListener('change', handlePdoDropdownChange);



        function handleHdlDataFixChange(event) {

            event.preventDefault(); // Prevent default behavior



            var spiCheckbox = document.getElementById('spi'); // Assuming you have a checkbox with this id

            var adminRunCheckbox = document.getElementById('admin_run'); // Assuming you have a checkbox with this id



            customConfirm("Do you have additional comments to Admin team on the SPI & PII Details?", function (result) {

                if (result) {

                    spiCheckbox.style.outline = '2px solid red';

                    spiCheckbox.checked = true;

                    adminRunCheckbox.checked = true;

                    checklistUpload('spi', 'yes');

                    checkSPI();

                    openMigrationChecklist("OPEN");

                    var form = document.getElementById('hcm_form');

                    var inputs = form.getElementsByTagName('input');

                    for (var i = 0; i < inputs.length; i++) {

                        inputs[i].disabled = false;

                    }

                    form.style.pointerEvents = 'auto';

                } else {

                    // User clicked "No"                      

                    spiCheckbox.style.outline = '0px solid darkblue';

                    spiCheckbox.checked = false;

                    adminRunCheckbox.checked = false;

                    checklistUpload('spi', 'no');

                    openMigrationChecklist("CLOSE");

                }

            });

        }



        function handlePdoDropdownChange(event) {

            var pdoDropdown = document.getElementById('pdo');

            var hdlDataFixCheckbox = document.getElementById('hdlDataFix');

            //alert(pdoDropdown.value);

            if (pdoDropdown.value === "trex") {

                hdlDataFixCheckbox.checked = true;

                handleHdlDataFixChange(event); // Manually trigger the change handler

            } else {

                hdlDataFixCheckbox.checked = false;

            }

        }

    </script>
    <script>
        // Checkbox mappings and functions

        var checkboxMappings = {

            corehr: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            falcon: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            blackbox: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            eagle: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            phoenix: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            frontier: ["bip", "valueset", "lookup", "udt", "otbi"],

            insights: ["bip", "fast-formula", "lookup", "udt", "otbi"],

            trex: ["bip", "valueset", "lookup", "fast-formula", "otbi", "cwbUpdate", "hdlDataFix"],

            learning: ["bip", "valueset", "lookup", "fast-formula", "payroll-flow", "hcm-extract"],

            mustang: ["bip", "valueset", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            recruitment: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            talent: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            cardinals: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"]

        };



        var specificPdos = ["frontier", "insights", "learning", "mustang", "recruitment", "talent"];



        var allCheckboxes = [...new Set(Object.values(checkboxMappings).flat())];

        allCheckboxes.push("partialMigration");



        function checkCheckboxes(checkboxIds) {

            checkboxIds.forEach(function (checkboxId) {

                var checkbox = document.getElementById(checkboxId);

                if (checkbox) {

                    checkbox.checked = true;

                }

            });

        }



        function uncheckCheckboxes(checkboxIds) {

            checkboxIds.forEach(function (checkboxId) {

                var checkbox = document.getElementById(checkboxId);

                if (checkbox) {

                    checkbox.checked = false;

                }

            });

        }







        function handleUncheckAll() {

            var uncheckAllBox = document.getElementById('uncheck_all');

            var pdoDropdown = document.getElementById("pdo");

            var selectedValue = pdoDropdown.options[pdoDropdown.selectedIndex].value;

            var partialMigrationText = document.getElementById('partialMigrationText');



            if (!uncheckAllBox.checked) {

                uncheckCheckboxes(checkboxMappings[selectedValue]);

                var partialMigrationCheckbox = document.getElementById('partialMigration');

                if (partialMigrationCheckbox) {

                    partialMigrationCheckbox.checked = false;

                }

            } else {

                checkCheckboxes(checkboxMappings[selectedValue]);

                var valuesetCheckbox = document.getElementById('valueset');

                if (valuesetCheckbox && valuesetCheckbox.checked) {

                    var partialMigrationCheckbox = document.getElementById('partialMigration');

                    if (partialMigrationCheckbox) {

                        partialMigrationCheckbox.checked = true;

                        partialMigrationCheckbox.disabled = true;

                        blinkText(partialMigrationText);

                        partialMigrationText.style.color = "orange";

                    }

                }

            }

        }



        function addEventListeners(checkboxIds) {

            checkboxIds.forEach(function (id) {

                var checkbox = document.getElementById(id);

                if (checkbox) {

                    checkbox.addEventListener('change', function () {

                        var uncheckAllBox = document.getElementById('uncheck_all');

                        var allChecked = checkboxIds.every(function (id) {

                            var cb = document.getElementById(id);

                            return cb && cb.checked;

                        });

                        uncheckAllBox.checked = allChecked;



                        if (id === 'valueset') {

                            var partialMigrationCheckbox = document.getElementById('partialMigration');

                            if (partialMigrationCheckbox) {

                                partialMigrationCheckbox.checked = checkbox.checked;

                            }

                        }

                    });

                }

            });

        }



        document.addEventListener('DOMContentLoaded', function () {

            //alert("DOM fully loaded and parsed");        



            var pdoDropdown = document.getElementById("pdo");

            var spiCheckbox = document.getElementById('spi');

            var adminRunCheckbox = document.getElementById('admin_run');

            var manualMigrationCheckbox = document.getElementById('manualMigration');

            var submitBtn = document.getElementById('submitBtn');

            var soxCheckbox = document.getElementById('sox');

            var lbl_sox_sp = document.getElementById('lbl_sox_sp');

            var txt_box_sox_sp = document.getElementById('txt_box_sox_sp');


            const supportText = document.querySelector('.support-text');
            const pdoSelect = document.getElementById("pdo");

            if (pdoSelect && pdoSelect.value === "kdfourtytwo") {
                supportText.style.display = "block"; // Show the support-text
            } else {
                supportText.style.display = "none"; // Hide the support-text
            }

            pdoSelect.addEventListener("change", function () {
                if (pdoSelect.value === "kdfourtytwo") {
                    supportText.style.display = "block";
                } else {
                    supportText.style.display = "none";
                }
            });



            if (pdoDropdown) {

                pdoDropdown.addEventListener('change', function (event) {



                    //              checkPDO(event);



                    //updateSubWorkstream();

                    updateMigrationScope();





                });

            }



            /*function checkPDO(event) {
       
                event.preventDefault(); // Prevent default behavior
       
                //alert("checkPDO function called"+pdoDropdown.value);
       
       
       
                if (pdoDropdown.value === "") {
       
                alert("Select PDO First");
       
                } else if (pdoDropdown.value === "corehr" || pdoDropdown.value === "mustang") {
       
                   
       
                    customConfirm("Do you have additional comments to Admin team on the SPI & PII Details?", function(result) {
       
                        if (result) {
       
                            if (pdoDropdown.value === "corehr" || pdoDropdown.value === "mustang") {
       
                 
       
                                spiCheckbox.style.outline = '2px solid red';
       
                                spiCheckbox.checked = true;
       
                                adminRunCheckbox.checked = true;
       
                                checklistUpload('spi','yes');
       
                                updateSubWorkstream();
       
                                updateMigrationScope();
       
                                openMigrationChecklist("OPEN");
       
                                var form = document.getElementById('hcm_form');
       
                                var inputs = form.getElementsByTagName('input');
       
                                for (var i = 0; i < inputs.length; i++) {
       
                                    inputs[i].disabled = false;
       
                                }
       
                            form.style.pointerEvents = 'auto';              
       
                            }
       
                         } else {
       
                            // User clicked "No"                        
       
                            spiCheckbox.style.outline = '0px solid darkblue';
       
                            spiCheckbox.checked = false;
       
                            adminRunCheckbox.checked = false;
       
                            checklistUpload('spi','no');
       
                            openMigrationChecklist("CLOSE");
       
                            updateMigrationScope();
       
                        }
       
                    });            
       
                   
       
                }
       
               
       
                else{              
       
                    spiCheckbox.style.outline = '0px solid darkblue';
       
                    spiCheckbox.checked = false;
       
                    adminRunCheckbox.checked = false;
       
                    checklistUpload('spi','no');
       
                    openMigrationChecklist("CLOSE");
       
                    updateMigrationScope();
       
                    }            
       
                   
       
            }*/









            function updateSubWorkstream() {

                var pdoDropdown = document.getElementById("pdo");

                //alert(pdoDropdown.value);

                var workstreamDropdown = document.getElementById("workstream");

                var subWorkstreamDropdown = document.getElementById("sub-workstream");

                var coreHR = '<option value="core_hr_absence_benefits">Core HR - Absence & Benefits</option>';

                var falcon = '<option value="row_nprl">ROW - NPRL</option><option value="eu_nprl">EU - NPRL</option><option value="eu_row_nprl_global">EU & ROW - NPRL - GLOBAL</option>';

                var eagle = '<option value="row_prl">ROW - PRL</option><option value="eu_prl">EU- PRL</option>';

                var blackbox = eagle + '<option value="uch">UCH</option><option value="us_payroll">US-PAYROLL</option>';

                var phoenix = '<option value="di_dashboard">DI DASHBOARD</option>';

                var kdfourtytwo = '<option value="kd42_EU_Payroll">KD42-EU-Payroll</option>';

                var frontier = '<option value="reporting_eu">Reporting - EU</option><option value="reporting_row">Reporting - ROW</option>';

                var insights = '<option value="iaaap">IAAAP</option><option value="iaaap_row">IAAAP-ROW</option><option value="iaaap_eu">IAAAP-EU</option><option value="iaaap_reports">IAAAP_REPORTS</option>';

                var trex = '<option value="security">Security</option>';

                var learning = '<option value="learning">Learning</option>';

                var cpo = '<option value="workforce_compensation">WORKFORCE_COMPENSATION</option>';

                var recruitment = '<option value="recruitment">Recruitment</option>';

                var talent = '<option value="talent">Talent</option>';

                var cardinals = '<option value="payroll_modernization">PAYROLL MODERNIZATION</option>';

                var uspayrollsupport = '<option value="uspayrollsupport">US Payroll Support</option>';

                var testpdo = '<option value="testing_purpose">Testing Purpose</option>';



                var defaultsubworkstream = '<option value="vbcs_migration">VBCS Migration </option><option value="page_personalization">Page Personalization </option>';

                //alert(pdoDropdown.value);

                if (pdoDropdown.value === "") {

                    workstreamDropdown.disabled = true;

                    subWorkstreamDropdown.disabled = true;

                    workstreamDropdown.innerHTML = `<option value="">Select Workstream</option>`;

                    subWorkstreamDropdown.innerHTML = `<option value="">Select Sub-Workstream</option>`;

                    alert("Please select PDO first.");

                } else {

                    workstreamDropdown.disabled = false;

                    subWorkstreamDropdown.disabled = false;



                    switch (pdoDropdown.value) {

                        case "corehr":

                            workstreamDropdown.innerHTML = `<option value="Core HR">Core HR</option>`;

                            subWorkstreamDropdown.innerHTML = `
     
                ${coreHR}
     
                ${falcon}
     
                ${blackbox}
     
                ${eagle}
     
                ${phoenix}
     
                ${frontier}
     
                ${insights}
     
                ${trex}
     
                ${learning}
     
                ${cpo}
     
                ${recruitment}
     
                ${cardinals}
     
               ${defaultsubworkstream}            
     
              `;

                            break;

                        case "falcon":

                            workstreamDropdown.innerHTML = '<option value="Integration">Integration</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${falcon}            
     
                ${blackbox}
     
                ${eagle}
     
                ${phoenix}
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "blackbox":

                            workstreamDropdown.innerHTML = '<option value="Integration">Integration</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${blackbox}            
     
                ${falcon}
     
                ${eagle}
     
                ${phoenix}            
     
                ${defaultsubworkstream}              
     
              `;

                            break;

                        case "eagle":

                            workstreamDropdown.innerHTML = '<option value="Integration">Integration</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${eagle}            
     
                ${falcon}
     
                ${blackbox}
     
                ${phoenix}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "phoenix":

                            workstreamDropdown.innerHTML = '<option value="DI - Dashboard">DI - Dashboard</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${phoenix}            
     
                ${falcon}
     
                ${blackbox}
     
                ${eagle}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "kdfourtytwo":

                            workstreamDropdown.innerHTML = `<option value="KD42-EU-Payroll">KD42-EU-Payroll</option>`;

                            subWorkstreamDropdown.innerHTML = `
     
                ${kdfourtytwo}
     
                ${coreHR}
     
                ${falcon}
     
                ${blackbox}
     
                ${eagle}
     
                ${phoenix}
     
                ${frontier}
     
                ${insights}
     
                ${trex}
     
                ${learning}
     
                ${cpo}            
     
                ${cardinals}
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "frontier":

                            workstreamDropdown.innerHTML = '<option value="Reporting">Reporting</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${frontier}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "insights":

                            workstreamDropdown.innerHTML = '<option value="IAAAP">IAAAP</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${insights}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "trex":

                            workstreamDropdown.innerHTML = '<option value="security">Security</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${trex}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "learning":

                            workstreamDropdown.innerHTML = '<option value="Learning">Learning</option>';

                            subWorkstreamDropdown.innerHTML = `
     
                ${learning}            
     
                ${defaultsubworkstream}              
     
              `;

                            break;

                        case "mustang":

                            workstreamDropdown.innerHTML = `<option value="CPO">CPO</option>`;

                            subWorkstreamDropdown.innerHTML = `
     
                ${cpo}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "recruitment":

                            workstreamDropdown.innerHTML = `
     
              <option value="Recruitment">Recruitment</option>
     
              `;

                            subWorkstreamDropdown.innerHTML = `
     
                ${recruitment}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "talent":

                            workstreamDropdown.innerHTML = `
     
              <option value="Talent">Talent</option>
     
              `;

                            subWorkstreamDropdown.innerHTML = `
     
                ${talent}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        case "cardinals":

                            workstreamDropdown.innerHTML = `<option value="Payroll_Modernization">Payroll Modernization</option>`;

                            subWorkstreamDropdown.innerHTML = `
     
                ${cardinals}            
     
                ${defaultsubworkstream}              
     
              `;

                            break;

                        case "uspayrollsupport":

                            workstreamDropdown.innerHTML = `<option value="uspayrollsupport">US Payroll Support</option>`;

                            subWorkstreamDropdown.innerHTML = `          
     
                ${uspayrollsupport}
     
               ${defaultsubworkstream}            
     
              `;

                            break;



                        case "testpdo":

                            workstreamDropdown.innerHTML = `<option value="testing_purpose">Testing Purpose</option>`;

                            subWorkstreamDropdown.innerHTML = `
     
                ${testpdo}            
     
                ${defaultsubworkstream}            
     
              `;

                            break;

                        default:

                            workstreamDropdown.value = "";

                            subWorkstreamDropdown.innerHTML = "";

                            break;

                    }

                }

            }

            document.getElementById("pdo").addEventListener("change", updateSubWorkstream);



            allCheckboxes.forEach(function (id) {

                var checkbox = document.getElementById(id);

                if (checkbox) {

                    checkbox.addEventListener('change', function () {

                        var uncheckAllBox = document.getElementById('uncheck_all');

                        var selectedValue = document.getElementById("pdo").value;

                        if (!checkbox.checked) {

                            uncheckAllBox.checked = false;

                        } else {

                            var allRelevantChecked = checkboxMappings[selectedValue].every(function (id) {

                                var cb = document.getElementById(id);

                                return cb && cb.checked;

                            });

                            uncheckAllBox.checked = allRelevantChecked;

                        }



                        if (id === 'valueset') {

                            var partialMigrationCheckbox = document.getElementById('partialMigration');

                            if (partialMigrationCheckbox) {

                                partialMigrationCheckbox.checked = checkbox.checked;

                            }

                        }

                    });

                }

            });



            // Prevent the form from submitting

            var form = document.getElementById('hcm_form');

            form.addEventListener('submit', function (event) {

                event.preventDefault();

            });



            // Prevent the button from causing a page refresh

            submitBtn.addEventListener('click', function (event) {

                event.preventDefault();

            });

        });



        function checkSPI() {

            var spiCheckbox = document.getElementById('spi');

            var spiApproval = document.getElementById('spi_upload');

            var spi_sp_url_lbl = document.getElementById('lbl_spi_sp_url');

            var spi_sp_url_txt_box = document.getElementById('txt_box_spi_sp_url');

            var admin_run_checkbox = document.getElementById('admin_run');

            if (spiCheckbox.checked == true) {



                spiCheckbox.style.outline = '2px solid red';

                admin_run_checkbox.checked = true;

                spi_sp_url_lbl.style.display = "block";

                spi_sp_url_txt_box.style.display = "block";

                spi_sp_url_txt_box.style.outline = "1px solid green";

                checklistUpload('spi', 'yes');



                openMigrationChecklist("OPEN");





            } else {

                spiCheckbox.style.outline = '0px solid darkblue';

                admin_run_checkbox.checked = false;

                spi_sp_url_lbl.style.display = "none";

                spi_sp_url_txt_box.style.display = "none";

                openMigrationChecklist("CLOSE");

                checklistUpload('spi', 'no');

            }

        }





        function checkMonth() {



            //var soxCheckbox = document.getElementById('sox');

            const soxCheckbox = document.getElementById('sox');

            const dateInput = document.getElementById('date');

            const selectedDate = new Date(dateInput.value);

            const selectedMonth = selectedDate.getMonth();

            const selectedPDO = document.getElementById('pdo').value;

            var section = document.getElementById("checklist");

            var soxFile = document.getElementById('sox_upload');

            var lightbox = document.getElementById('confirmBox');

            var lbl_sox_sp = document.getElementById('lbl_sox_sp_url');

            var txt_box_sox_sp = document.getElementById('txt_box_sox_sp_url');



            if (!(selectedPDO == 'falcon' || selectedPDO == 'phoenix' || selectedPDO == 'trex' || selectedPDO == 'learning')) {



                if (selectedMonth == 2 || selectedMonth == 5 || selectedMonth == 8 || selectedMonth == 10 || selectedMonth == 11) {



                    customConfirm("Do you have SOX Migration Approval to proceed?", function (resultSOX) {

                        if (resultSOX) {

                            soxCheckbox.checked = true;

                            soxCheckbox.style.outline = '2px solid red';

                            checklistUpload('sox', 'yes');

                            lbl_sox_sp.style.display = "block";

                            txt_box_sox_sp.style.display = "block";

                            openMigrationChecklist("OPEN");

                            var form = document.getElementById('hcm_form');

                            var inputs = form.getElementsByTagName('input');

                            for (var i = 0; i < inputs.length; i++) {

                                inputs[i].disabled = false;

                            }

                            form.style.pointerEvents = 'auto';

                        } else {

                            // Other conditions or actions if selectedMonth is not March, June, September, November, or December

                            soxCheckbox.checked = false;

                            soxCheckbox.style.outline = '0px solid darkblue';

                            section.style.display = 'block';

                            var soxFile = document.getElementById('sox_upload');

                            soxFile.style.display = "none";

                            lbl_sox_sp.style.display = "none";

                            txt_box_sox_sp.style.display = "none";

                            openMigrationChecklist("CLOSE");

                            checklistUpload('sox', 'no');

                        }

                    });

                } else {

                    soxCheckbox.checked = false;

                    soxCheckbox.style.outline = '0px solid darkblue';

                    section.style.display = 'block';

                    var soxFile = document.getElementById('sox_upload');

                    soxFile.style.display = "none";

                    lbl_sox_sp.style.display = "none";

                    txt_box_sox_sp.style.display = "none";

                    openMigrationChecklist("CLOSE");

                    checklistUpload('sox', 'no');

                }

            } else {

                soxCheckbox.checked = false;

                soxCheckbox.style.outline = '0px solid darkblue';

                section.style.display = 'block';

                var soxFile = document.getElementById('sox_upload');

                soxFile.style.display = "none";

                lbl_sox_sp.style.display = "none";

                txt_box_sox_sp.style.display = "none";

                openMigrationChecklist("CLOSE");

                checklistUpload('sox', 'no');

            }

        }





        function customConfirm(message, callback) {

            var lightbox = document.getElementById('confirmBox');

            var messageElement = document.getElementById('confirmMessage');

            messageElement.textContent = message;

            lightbox.style.display = 'block';



            var yesButton = document.getElementById('yesButton');

            yesButton.addEventListener('click', function () {

                event.preventDefault();

                lightbox.style.display = 'none';

                callback(true);

            });



            var noButton = document.getElementById('noButton');

            noButton.addEventListener('click', function () {

                event.preventDefault(); // Prevent default action for the "No" button

                callback(false);

                lightbox.style.display = 'none';

                var form = document.getElementById('hcm_form');

                var inputs = form.getElementsByTagName('input');

                for (var i = 0; i < inputs.length; i++) {

                    inputs[i].disabled = false;

                }

                form.style.pointerEvents = 'auto';

            });



            var form = document.getElementById('hcm_form');

            var inputs = form.getElementsByTagName('input');

            for (var i = 0; i < inputs.length; i++) {

                inputs[i].disabled = true;

            }

            form.style.pointerEvents = 'none';

        }



        function checklistUpload(ID, DISPLAY_STATUS) {



            var checklist_upload_button = document.getElementById(ID + "_upload");



            var checkbox_id = document.getElementById(ID);



            //    alert(ID + checkbox_id.checked);

            if (checkbox_id.checked) {

                checklist_upload_button.style.display = "block";

                DISPLAY_STATUS = "YES";

            }

            else {

                checklist_upload_button.style.display = "none";

                DISPLAY_STATUS = "NO";

            }









            // Convert DISPLAY_STATUS to uppercase and check if it is 'YES'

            if (DISPLAY_STATUS.toUpperCase() == 'YES') {

                checklist_upload_button.style.display = "block";



            } else {

                checklist_upload_button.style.display = "none";

            }

        }





        function openMigrationChecklist(DISPLAY_STATUS) {

            var section = document.getElementById("checklist");

            if (DISPLAY_STATUS === "OPEN") {

                //var arrowIcon = document.getElementById(arrowIconId);  

                section.style.display = 'block';

                //arrowIcon.innerHTML = '&#9650;'; // Up arrow  

            }

            else {

                section.style.display = 'none';

            }





        }

    </script>
    <script>
        function checkER() {

            var emergencyCheckBox = document.getElementById('toggleSwitch');

            var priorityDropDown = document.getElementById('prioritySelect');

            //alert(emergencyCheckBox.checked);

            if (emergencyCheckBox.checked) {

                priorityDropDown.innerHTML = '<option value="Critical">Critical</option><option value="Medium">Medium</option><option value="High">High</option><option value="Low">Low</option>';

            }

            else {

                priorityDropDown.innerHTML = '<option value="Medium">Medium</option><option value="Critical">Critical</option><option value="High">High</option><option value="Low">Low</option>';

            }

        }

    </script>
    <script>
        function toggleFullScreen() {

            var elem = document.documentElement;



            if (!document.fullscreenElement && !document.mozFullScreenElement &&

                !document.webkitFullscreenElement && !document.msFullscreenElement) {

                if (elem.requestFullscreen) {

                    elem.requestFullscreen();

                } else if (elem.msRequestFullscreen) {

                    elem.msRequestFullscreen();

                } else if (elem.mozRequestFullScreen) {

                    elem.mozRequestFullScreen();

                } else if (elem.webkitRequestFullscreen) {

                    elem.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);

                }

                document.getElementById('fullscreenLink').innerText = 'Exit Full Screen Mode';

            } else {

                if (document.exitFullscreen) {

                    document.exitFullscreen();

                } else if (document.msExitFullscreen) {

                    document.msExitFullscreen();

                } else if (document.mozCancelFullScreen) {

                    document.mozCancelFullScreen();

                } else if (document.webkitExitFullscreen) {

                    document.webkitExitFullscreen();

                }

                document.getElementById('fullscreenLink').innerText = 'Open Full Screen';

            }

        }



    </script>
    <script>
        function enterFullScreen() {

            var elem = document.documentElement;



            if (elem.requestFullscreen) {

                elem.requestFullscreen().then(() => {

                    elem.requestFullscreen();

                });

            } else if (elem.msRequestFullscreen) {

                elem.msRequestFullscreen();

            } else if (elem.mozRequestFullScreen) {

                elem.mozRequestFullScreen();

            } else if (elem.webkitRequestFullscreen) {

                elem.webkitRequestFullscreen();

            }



            document.addEventListener("fullscreenchange", function () {

                if (!document.fullscreenElement) {

                    enterFullScreen();

                }

            });

        }

    </script>
    <!--script>
      document.addEventListener('contextmenu', event => {
     
              event.preventDefault();
     
      });
     
      </script-->
    <!--script>
      document.addEventListener('keydown', function(e) {
     
      // Disable F12 key
     
      if (e.key === "F12" || e.keyCode=== 123) {
     
          alert("F12 is disabled!");
     
          e.preventDefault();
     
          return false;
     
      }
     
          // Disable F12 key
     
      if (e.key === "F11" || e.keyCode=== 122) {
     
          //alert("F11 is disabled!");
     
          //e.preventDefault();
     
         // return false;
     
      }
     
     
     
      // Disable Esc key
     
      if (e.key === "Escape" || e.keyCode === 27) {
     
          e.preventDefault();
     
          return false;
     
      }
     
      });
     
      </script-->
    <script>
        function resetForm() {

            document.getElementById('hcm_form').reset();

            location.reload();

        }



    </script>
    <script>
        // Get the source and target dropdown elements

        var sourceSelect = document.getElementById("sourceSelect");

        var targetSelect = document.getElementById("targetSelect");



        // Add event listeners to both dropdowns to check for changes

        sourceSelect.addEventListener("change", checkSelection);

        targetSelect.addEventListener("change", checkSelection);



        function checkSelection() {

            var sourceText = sourceSelect.options[sourceSelect.selectedIndex].innerText;

            var targetText = targetSelect.options[targetSelect.selectedIndex].innerText;



            // Check if the selected texts are the same in either direction

            if (sourceText === targetText) {

                if (this === sourceSelect) {

                    alert("Source and target environments should not be the same. Please select a different source.");

                    // Reset the source dropdown to the default option

                    sourceSelect.selectedIndex = 0;

                } else {

                    alert("Source and target environments should not be the same. Please select a different target.");

                    // Reset the target dropdown to the default option

                    targetSelect.selectedIndex = 0;

                }

            }

        }





    </script>
    <script>
        function handleMigrationSelection() {

            var selectedValue = document.getElementById("categorySelect").value;



            if (selectedValue === "Re-Migration") {

                var oldSharepointId = prompt("Enter Your Re Migration Reference SharePoint ID");



                if (oldSharepointId) {

                    var confirmMigration = confirm("Are you sure to re-migrate this SharePoint ID " + oldSharepointId + "?");



                    if (confirmMigration) {

                        document.getElementById("ReMigrationText").innerHTML = "(Refer your Existing  Migration Request: " + oldSharepointId + ")";

                    }

                }

            }

        }

    </script>
    <script>
        function checklistAll() {

            //var all_checkbutton = document.getElementById("all_checklist");

            checkChecklist('begin_development');

            checkChecklist('unit_test');

            checkChecklist('code_review');

            checkChecklist('sit_uat');

        }



        function checkChecklist(ID) {

            var all_checkbutton = document.getElementById("all_checklist");

            if (all_checkbutton.checked == true) {

                document.getElementById(ID).checked = true;

                checklistUpload(ID);

            }

            else {

                document.getElementById(ID).checked = false;

                checklistUpload(ID);

            }



        }

    </script>
    <!--script>
      function updateMigrationScope() {
     
      var pdoDropdown = document.getElementById("pdo");
     
      var selectedValue = pdoDropdown.options[pdoDropdown.selectedIndex].value;
     
     
     
      // Mapping of PDO values to checkbox IDs
     
      var checkboxMappings = {
     
          corehr: ["bip","valueset","lookup","fast-formula","udt","payroll-flow","hcm-extract"],
     
          falcon: ["bip","valueset","lookup","fast-formula","udt","payroll-flow","hcm-extract"],
     
          blackbox: ["bip","valueset","lookup","fast-formula","udt","payroll-flow","hcm-extract"],
     
          eagle: ["bip","valueset","lookup","fast-formula","udt","payroll-flow","hcm-extract"],
     
          phoenix: ["bip","valueset","lookup","fast-formula","udt","payroll-flow","hcm-extract"],
     
          frontier: ["bip","valueset","lookup","udt","otbi"],
     
          insights: ["bip","fast-formula","lookup","udt","otbi"],
     
          trex: ["bip","valueset","lookup","fast-formula","otbi","cwbUpdate","hdlDataFix"],
     
          learning: ["bip","valueset","lookup","fast-formula","payroll-flow","hcm-extract"],
     
          mustang: ["bip","valueset","fast-formula","udt","payroll-flow","hcm-extract"],
     
          rec_talent: ["bip","valueset","lookup","fast-formula","udt","payroll-flow","hcm-extract"],
     
          cardinals: ["bip","valueset","lookup","fast-formula","udt","payroll-flow","hcm-extract"]
     
      };
     
     
     
      // Reset all checkboxes to unchecked
     
      var checkboxes = document.querySelectorAll('.checkbox-grid-8-columns input[type="checkbox"]');
     
      checkboxes.forEach(function(checkbox) {
     
          checkbox.checked = false;
     
      });
     
     
     
      // Check checkboxes based on selected PDO value
     
      checkboxMappings[selectedValue].forEach(function(checkboxId) {
     
          document.getElementById(checkboxId).checked = true;
     
      });
     
      }
     
      </script>
     
      <script>
     
      // Get all the checkboxes
     
      var checkboxes = document.querySelectorAll('input[type="checkbox"]');
     
      var manualMigrationCheckbox = document.getElementById("manualMigration");
     
      var adminRunCheckbox = document.getElementById("admin_run");
     
      var essentialCheckboxes = ["sox", "spi", "admin_run", "cwb-update", "balanceGroups", "balanceGroupsUsages", "hdlDataFix"];
     
     
     
      // Function to handle checkbox changes
     
      function handleCheckboxChange(checkbox) {
     
      if (essentialCheckboxes.includes(checkbox.id) && checkbox.checked) {
     
          manualMigrationCheckbox.addEventListener('change', function() {
     
              if (!this.checked) {
     
                  alert("You cannot uncheck Manual Migration while one of the checkboxes is checked: " + checkbox.value);
     
                  this.checked = true;
     
              }
     
          });
     
      }
     
     
     
      if (checkbox === manualMigrationCheckbox && checkbox.checked) {
     
          adminRunCheckbox.checked = true;
     
      }
     
     
     
      if (checkbox === adminRunCheckbox && !checkbox.checked) {
     
          var otherCheckboxesChecked = essentialCheckboxes.some(function(id) {
     
             var cb = document.getElementById(id);
     
              return cb !== checkbox && cb.checked;
     
          });
     
          if (!otherCheckboxesChecked) {
     
              manualMigrationCheckbox.checked = false;
     
          }
     
      }
     
      }
     
     
     
      // Add event listener to each checkbox
     
      checkboxes.forEach(function(checkbox) {
     
      checkbox.addEventListener('change', function() {
     
          handleCheckboxChange(checkbox);
     
      });
     
      });
     
     
     
      </script-->
    <script>
        // Define the mapping of PDO values to checkbox IDs

        // Define the mapping of PDO values to checkbox IDs

        var checkboxMappings = {

            corehr: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            falcon: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            blackbox: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            eagle: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            phoenix: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            frontier: ["bip", "valueset", "lookup", "udt", "otbi"],

            insights: ["bip", "fast-formula", "lookup", "udt", "otbi"],

            trex: ["bip", "valueset", "lookup", "fast-formula", "otbi", "cwbUpdate", "hdlDataFix"],

            learning: ["bip", "valueset", "lookup", "fast-formula", "payroll-flow", "hcm-extract"],

            mustang: ["bip", "valueset", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            recruitment: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            talent: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

            cardinals: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"]

        };



        // Specific PDOs to show only relevant checkboxes

        var specificPdos = ["frontier", "insights", "learning", "mustang", "recruitment", "talent"];



        // Flatten the array to get unique checkbox IDs

        var allCheckboxes = [...new Set(Object.values(checkboxMappings).flat())];



        // Add partialMigration to the list of all checkboxes

        allCheckboxes.push("partialMigration");



        // Function to check specific checkboxes

        function checkCheckboxes(checkboxIds) {

            checkboxIds.forEach(function (checkboxId) {

                var checkbox = document.getElementById(checkboxId);

                if (checkbox) {

                    checkbox.checked = true;

                }

            });

        }



        // Function to uncheck specific checkboxes

        function uncheckCheckboxes(checkboxIds) {

            checkboxIds.forEach(function (checkboxId) {

                var checkbox = document.getElementById(checkboxId);

                if (checkbox) {

                    checkbox.checked = false;

                }

            });

        }



        // Function to update the migration scope

        function updateMigrationScope() {

            var pdoDropdown = document.getElementById("pdo");


            var selectedValue = pdoDropdown.options[pdoDropdown.selectedIndex].value;

            //         alert(selectedValue);



            //    alert(selectedValue);





            // Mapping of PDO values to checkbox IDs

            var checkboxMappings = {

                corehr: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                falcon: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                blackbox: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                eagle: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                kdfourtytwo: ["bip", "valueset", "fast-formula"],

                phoenix: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                frontier: ["bip", "valueset", "lookup", "udt", "otbi"],

                insights: ["bip", "fast-formula", "lookup", "udt", "otbi"],

                trex: ["bip", "valueset", "lookup", "fast-formula", "otbi", "cwbUpdate", "hdlDataFix"],

                learning: ["bip", "valueset", "lookup", "fast-formula", "payroll-flow", "hcm-extract"],

                mustang: ["bip", "valueset", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                talent: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                recruitment: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                cardinals: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                uspayrollsupport: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],

                testpdo: ["bip"]

            };



            // Reset all checkboxes to unchecked

            var checkboxes = document.querySelectorAll('.checkbox-grid-8-columns input[type="checkbox"]');

            checkboxes.forEach(function (checkbox) {

                checkbox.checked = false;

            });





            // Check checkboxes based on selected PDO value

            checkboxMappings[selectedValue].forEach(function (checkboxId) {

                var checkbox = document.getElementById(checkboxId);

                checkbox.checked = true;

                if (checkboxId === "cwbUpdate" || checkboxId === "hdlDataFix") {

                    var manualMigrationCheckbox = document.getElementById('manualMigration');

                    manualMigrationCheckbox.checked = true;

                    blinkText(document.getElementById('manualMigrationText'));

                }

            });



            var valuesetCheckbox = document.getElementById('valueset');

            var admin_run_checkbox1 = document.getElementById("admin_run");

            if (valuesetCheckbox && valuesetCheckbox.checked) {

                var partialMigrationCheckbox = document.getElementById('partialMigration');

                if (partialMigrationCheckbox) {

                    partialMigrationCheckbox.disabled = true;

                    partialMigrationCheckbox.checked = true;

                    admin_run_checkbox1.checked = true;



                    //partialMigrationCheckbox.disabled = true;

                    blinkText(partialMigrationText);

                    //partialMigrationCheckbox.style.outline = "2px solid orange";

                    partialMigrationText.style.color = "orange";

                }

                else {

                    partialMigrationText.style.color = "black";



                }

            }





            var uncheckAllBox = document.getElementById('uncheck_all');

            uncheckAllBox.checked = true;

        }



        // Handle uncheck_all checkbox click

        function handleUncheckAll() {

            var uncheckAllBox = document.getElementById('uncheck_all');

            var pdoDropdown = document.getElementById("pdo");

            var selectedValue = pdoDropdown.options[pdoDropdown.selectedIndex].value;

            var partialMigrationText = document.getElementById('partialMigrationText');

            var adminRunCheckbox1 = document.getElementById('admin_run');

            var soxcb = document.getElementById('sox');

            var spicb = document.getElementById('spi');



            if (!uncheckAllBox.checked) {

                // Uncheck relevant checkboxes

                uncheckCheckboxes(checkboxMappings[selectedValue]);

                // Uncheck partialMigration checkbox

                var partialMigrationCheckbox = document.getElementById('partialMigration');

                if (partialMigrationCheckbox && (!soxcb.checked || !spicb.checked)) {

                    if (!soxcb.checked && !spicb.checked) {

                        adminRunCheckbox1.checked = false;

                    }

                    partialMigrationCheckbox.checked = false;

                }

            } else {

                // Check relevant checkboxes

                checkCheckboxes(checkboxMappings[selectedValue]);

                // Check partialMigration if valueset is checked

                var valuesetCheckbox = document.getElementById('valueset');

                if (valuesetCheckbox && valuesetCheckbox.checked) {

                    var partialMigrationCheckbox = document.getElementById('partialMigration');

                    if (partialMigrationCheckbox) {

                        partialMigrationCheckbox.checked = true;

                        partialMigrationCheckbox.disabled = true;

                        blinkText(partialMigrationText);

                        //partialMigrationCheckbox.style.outline = "2px solid orange";

                        partialMigrationText.style.color = "orange";

                        adminRunCheckbox1.checked = true;

                    }

                }

            }

        }



        // Add event listeners to check/uncheck all relevant checkboxes on manual checkbox change

        function addEventListeners(checkboxIds) {

            checkboxIds.forEach(function (id) {

                var checkbox = document.getElementById(id);

                if (checkbox) {

                    checkbox.addEventListener('change', function () {

                        var uncheckAllBox = document.getElementById('uncheck_all');

                        var allChecked = checkboxIds.every(function (id) {

                            var cb = document.getElementById(id);

                            return cb && cb.checked;

                        });

                        uncheckAllBox.checked = allChecked;



                        // Check/uncheck partialMigration based on the state of valueset

                        if (id === 'valueset') {

                            var partialMigrationCheckbox = document.getElementById('partialMigration');

                            if (partialMigrationCheckbox) {

                                partialMigrationCheckbox.checked = checkbox.checked;

                            }

                        }

                    });

                }

            });

        }



        // Add event listeners to all checkboxes on page load

        document.addEventListener('DOMContentLoaded', function () {

            allCheckboxes.forEach(function (id) {

                var checkbox = document.getElementById(id);

                if (checkbox) {

                    checkbox.addEventListener('change', function () {

                        var uncheckAllBox = document.getElementById('uncheck_all');

                        var selectedValue = document.getElementById("pdo").value;

                        if (!checkbox.checked) {

                            uncheckAllBox.checked = false;

                        } else {

                            var allRelevantChecked = checkboxMappings[selectedValue].every(function (id) {

                                var cb = document.getElementById(id);

                                return cb && cb.checked;

                            });

                            uncheckAllBox.checked = allRelevantChecked;

                        }



                        // Check/uncheck partialMigration based on the state of valueset

                        if (id === 'valueset') {

                            var partialMigrationCheckbox = document.getElementById('partialMigration');

                            if (partialMigrationCheckbox) {

                                partialMigrationCheckbox.checked = checkbox.checked;

                            }

                        }

                    });

                }

            });

        });

    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {

            const sourceSelect = document.getElementById('sourceSelect');

            const targetSelect = document.getElementById('targetSelect');

            const migrationText = document.getElementById('MigrationText');







            const higherEnvironments = ['sourceDev16', 'sourceTest', 'sourcePROD', 'targetDev16', 'targetTEST', 'targetPROD'];

            const lowerEnvironments = ['sourceDev1', 'sourceDev2', 'sourceDev3', 'sourceDev4', 'sourceDev5', 'sourceDev9', 'sourceDev15', 'sourceDev17',

                'targetDev1', 'targetDev2', 'targetDev3', 'targetDev4', 'targetDev5', 'targetDev9', 'targetDev15', 'targetDev17'];



            function updateMigrationText() {

                const sourceValue = sourceSelect.value;

                const targetValue = targetSelect.value;



                //alert('Source value: ' + sourceValue);

                //alert('Target value: ' + targetValue);



                if (sourceValue === 'sourceDefault' || targetValue === 'targetDefault') {

                    migrationText.textContent = ''; // Clear the message if default value is selected

                    return;

                }



                if (higherEnvironments.includes(sourceValue) && lowerEnvironments.includes(targetValue)) {

                    migrationText.textContent = '[Unscramble Higher to Lower (Upload Migration Form)]';

                    //alert('Higher to lower environment');

                } else if (lowerEnvironments.includes(sourceValue) && higherEnvironments.includes(targetValue)) {

                    migrationText.textContent = '[Unscramble Lower to Higher(Upload Migration Form)]';

                    //alert('Lower to higher environment');

                } else if (sourceValue === 'sourceTest' && targetValue === 'targetDev16') {

                    migrationText.textContent = '[Unscramble Higher to Higher(Upload Migration Form)]';

                } else if (sourceValue === 'sourceDev16' && targetValue === 'targetTEST') {

                    migrationText.textContent = '[Unscramble Higher to Higher(Upload Migration Form)]';

                } else if (sourceValue === 'sourcePROD' && targetValue === 'targetTEST') {

                    migrationText.textContent = '[Higher to Lower(Upload Migration Form)]';

                } else if (sourceValue === 'sourcePROD' && targetValue === 'targetDev16') {

                    migrationText.textContent = '[Higher to Lower(Upload Migration Form)]';

                } else if (sourceValue === 'sourceTest' && targetValue === 'targetPROD') {

                    migrationText.textContent = '[Unscramble Lower to Higher(Upload Migration Form)]';

                } else if (sourceValue === 'sourceDev16' && targetValue === 'targetPROD') {

                    migrationText.textContent = '[Unscramble Lower to Higher(Upload Migration Form)]';

                } else if (lowerEnvironments.includes(sourceValue) && lowerEnvironments.includes(targetValue)) {

                    migrationText.textContent = '[Scramble Lower to Lower(Upload Migration Form)]';

                    //alert('Lower to lower environment');

                } else {

                    migrationText.textContent = '';

                    //alert('No valid environment match');

                }

            }



            sourceSelect.addEventListener('change', updateMigrationText);

            targetSelect.addEventListener('change', updateMigrationText);

            hdlDataFixCheckboxElement.addEventListener('change', checkPDO);



        });

    </script>
    <!--script>
      // Arrays of checkbox IDs for each category
     
      // Arrays of checkbox IDs for each category
     
      const categories = {
     
        corehr: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract","partialMigration"],
     
        falcon: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],
     
        blackbox: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],
     
        eagle: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],
     
        phoenix: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],
     
        frontier: ["bip", "valueset", "lookup", "udt", "otbi"],
     
        insights: ["bip", "fast-formula", "lookup", "udt", "otbi"],
     
        trex: ["bip", "valueset", "lookup", "fast-formula", "otbi", "cwbUpdate", "hdlDataFix"],
     
        learning: ["bip", "valueset", "lookup", "fast-formula", "payroll-flow", "hcm-extract"],
     
        mustang: ["bip", "valueset", "fast-formula", "udt", "payroll-flow", "hcm-extract"],
     
        rec_talent: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"],
     
        cardinals: ["bip", "valueset", "lookup", "fast-formula", "udt", "payroll-flow", "hcm-extract"]
     
      };
     
       
     
      // Flatten the array to get unique checkbox IDs
     
      const allCheckboxes = [...new Set(Object.values(categories).flat())];
     
       
     
      function handleUncheckAll() {
     
        //alert('Uncheck All Clicked'); // Alert to check if the function is being called
     
        const uncheckAllBox = document.getElementById('uncheck_all');
     
        if (uncheckAllBox.checked) {
     
          // Uncheck all specified checkboxes
     
          allCheckboxes.forEach(id => {
     
            document.getElementById(id).checked = false;
     
          });
     
        }
     
      }
     
       
     
      // Add event listeners to disable uncheck_all checkbox when any of the specified checkboxes are checked
     
      allCheckboxes.forEach(id => {
     
        const checkbox = document.getElementById(id);
     
        checkbox.addEventListener('change', () => {
     
          const uncheckAllBox = document.getElementById('uncheck_all');
     
          if (checkbox.checked) {
     
            uncheckAllBox.disabled = true;
     
          } else {
     
            // Re-enable uncheck_all checkbox if none of the specified checkboxes are checked
     
            const anyChecked = allCheckboxes.some(id => document.getElementById(id).checked);
     
            uncheckAllBox.disabled = anyChecked;
     
          }
     
        });
     
      });
     
       
     
      </script-->
    <script>
        // Assuming you have the following ids for the source and target select elements

        var sourceSelect = document.getElementById("sourceSelect");

        var targetSelect = document.getElementById("targetSelect");

        var sitUatCheckbox = document.getElementById("sit_uat");

        var beginDevelopmentCheckbox = document.getElementById("begin_development");

        var codeReviewCheckbox = document.getElementById("code_review");

        var unitTestCheckbox = document.getElementById("unit_test");



        var commitIndicator = document.getElementById("commitIndicator");

        var githubUrlIndicator = document.getElementById("githubUrlIndicator");

        var githubCommitId = document.getElementById("githubCommitId");

        var githubURL = document.getElementById("githubURL");



        sourceSelect.addEventListener('change', updateCheckboxes);

        targetSelect.addEventListener('change', updateCheckboxes);



        function updateCheckboxes() {

            const source = sourceSelect.value;

            const target = targetSelect.value;



            // Reset all checkboxes

            beginDevelopmentCheckbox.checked = false;

            unitTestCheckbox.checked = false;

            codeReviewCheckbox.checked = false;

            sitUatCheckbox.checked = false;

            checklistUpload('begin_development', 'NO');

            checklistUpload('code_review', 'NO');

            checklistUpload('unit_test', 'NO');

            checklistUpload('sit_uat', 'NO');



            // Define lower, higher, and super higher environments

            const lowerEnvironments = ['sourceDev1', 'sourceDev2', 'sourceDev3', 'sourceDev4', 'sourceDev5', 'sourceDev9', 'sourceDev15', 'sourceDev17'];

            const higherEnvironments = ['sourceTest', 'sourceDev16', 'targetTEST', 'targetDev16'];

            const superHigherEnvironments = ['sourcePROD', 'targetPROD'];



            // Get your admin activity select element.

            let adminActivitySelect = document.getElementById("manual_admin_activities");



            // Determine the list of selected admin activity options.

            let selectedAdminActivities = Array.from(adminActivitySelect.options)

                .filter(option => option.selected)

                .map(option => option.value);



            // Check if one of the two activities is selected.

            let isExcludedActivitySelected = selectedAdminActivities.includes("admin_activity_vbcs_migration") ||

                selectedAdminActivities.includes("admin_activity_page_personalization");



            // Check conditions

            if (lowerEnvironments.includes(source) && higherEnvironments.includes(target)) {

                // Lower to Higher

                openMigrationChecklist("OPEN");

                beginDevelopmentCheckbox.checked = true;

                unitTestCheckbox.checked = true;

                codeReviewCheckbox.checked = true;

                checklistUpload('begin_development');

                checklistUpload('code_review');

                checklistUpload('unit_test');

                checklistUpload('sit_uat', 'no');

                if (isExcludedActivitySelected) {

                    // For VBCS Migration or Page Personalization, do not display commit indicator.

                    commitIndicator.style.display = "none";

                    githubUrlIndicator.style.display = "none";

                    githubCommitId.required = false;

                    githubURL.required = false;

                } else {

                    // Otherwise, follow default behavior.

                    commitIndicator.style.display = "inline";

                    githubUrlIndicator.style.display = "none";

                    githubCommitId.required = true;

                    githubURL.required = true;

                }

            } else if (higherEnvironments.includes(source) && superHigherEnvironments.includes(target)) {

                // Higher to Super Higher

                openMigrationChecklist("OPEN");

                sitUatCheckbox.checked = true;

                checklistUpload('begin_development', 'no');

                checklistUpload('code_review', 'no');

                checklistUpload('unit_test', 'no');

                checklistUpload('sit_uat', 'yes');

            } else if (higherEnvironments.includes(source) && higherEnvironments.includes(target)) {

                // Higher to Higher

                openMigrationChecklist("OPEN");

                sitUatCheckbox.checked = true;

                checklistUpload('begin_development', 'no');

                checklistUpload('code_review', 'no');

                checklistUpload('unit_test', 'no');

                checklistUpload('sit_uat', 'yes');

            } else if (lowerEnvironments.includes(source) && lowerEnvironments.includes(target)) {

                // Lower to Lower

                //alert("Test");

                /*  checklistUpload('begin_development','no');
           
                    checklistUpload('code_review','no');
           
                    checklistUpload('unit_test','no');
           
                    checklistUpload('sit_uat','no');*/

                openMigrationChecklist("CLOSE");

            } else if (superHigherEnvironments.includes(source) && lowerEnvironments.includes(target)) {

                // Super Higher to Lower

                checklistUpload('begin_development', 'no');

                checklistUpload('code_review', 'no');

                checklistUpload('unit_test', 'no');

                checklistUpload('sit_uat', 'no');

                openMigrationChecklist("CLOSE");

            } else if (superHigherEnvironments.includes(source) && higherEnvironments.includes(target)) {

                // Super Higher to Higher

                openMigrationChecklist("CLOSE");

                checklistUpload('begin_development', 'no');

                checklistUpload('code_review', 'no');

                checklistUpload('unit_test', 'no');

                checklistUpload('sit_uat', 'no');

            } else if (higherEnvironments.includes(source) && lowerEnvironments.includes(target)) {

                // Higher to Lower



                checklistUpload('begin_development', 'no');

                checklistUpload('code_review', 'no');

                checklistUpload('unit_test', 'no');

                checklistUpload('sit_uat', 'no');

                openMigrationChecklist("CLOSE");

            }

        }

    </script>
    <!--script>
      // Assuming you have the following ids for the source and target select elements
     
      var sourceSelect = document.getElementById("sourceSelect");
     
      var targetSelect = document.getElementById("targetSelect");
     
      var sitUatCheckbox = document.getElementById("sit_uat");
     
      var beginDevelopmentCheckbox = document.getElementById("begin_development");
     
      var codeReviewCheckbox = document.getElementById("code_review");
     
      var unitTestCheckbox = document.getElementById("unit_test");
     
     
     
      sourceSelect.addEventListener('change', function() {
     
          updateCheckboxes();
     
      });
     
     
     
      targetSelect.addEventListener('change', function() {
     
          updateCheckboxes();
     
      });
     
     
     
      function updateCheckboxes() {
     
     
     
          var selectedSource = sourceSelect.value;
     
          var selectedTarget = targetSelect.value;      
     
          var higherEnvironments = ['sourceDev16', 'sourceTest', 'sourcePROD', 'targetDev16', 'targetTEST', 'targetPROD'];
     
          var lowerEnvironments = ['sourceDev1', 'sourceDev2', 'sourceDev3', 'sourceDev4', 'sourceDev5', 'sourceDev9', 'sourceDev15', 'sourceDev17',
     
                                     'targetDev1', 'targetDev2', 'targetDev3', 'targetDev4', 'targetDev5', 'targetDev9', 'targetDev15', 'targetDev17'];
     
          if(higherEnvironments.includes(selectedSource) && lowerEnvironments.includes(selectedTarget)) {
     
              beginDevelopmentCheckbox.checked = false;
     
              codeReviewCheckbox.checked = false;
     
              unitTestCheckbox.checked = false;
     
              sitUatCheckbox.checked = false;
     
              } else if(lowerEnvironments.includes(selectedSource) && higherEnvironments.includes(selectedTarget)) {
     
              beginDevelopmentCheckbox.checked = false;
     
              codeReviewCheckbox.checked = false;
     
              unitTestCheckbox.checked = false;
     
              sitUatCheckbox.checked = false;
     
              } else if((selectedSource === "sourceDev16" || selectedSource === "sourceTest") && selectedTarget === "targetPROD") {              
     
                  sitUatCheckbox.checked = true;  
     
                  checklistUpload('sit_uat');
     
                  openMigrationChecklist("OPEN");
     
              }else if(selectedTarget === "targetTEST" || selectedTarget === "targetDev16") {
     
                  //alert("Test");
     
                  beginDevelopmentCheckbox.checked = true;
     
                  codeReviewCheckbox.checked = true;
     
                  unitTestCheckbox.checked = true;
     
                  checklistUpload('begin_development');
     
                  checklistUpload('code_review');
     
                  checklistUpload('unit_test');
     
                  openMigrationChecklist("OPEN");
     
                  }
     
                  else
     
                  {
     
                      beginDevelopmentCheckbox.checked = false;
     
                      codeReviewCheckbox.checked = false;
     
                      unitTestCheckbox.checked = false;
     
                      sitUatCheckbox.checked = false;
     
                  }
     
              /*sitUatCheckbox.checked = true;
     
              checklistUpload('sit_uat');
     
              toggleSection('checklist', 'checklistarrow');
     
              }
     
              // Check if SIT_UAT should be selected
     
          if ((selectedSource === "sourceDev16" || selectedSource === "sourceTest") && selectedTarget === "targetPROD") {
     
              sitUatCheckbox.checked = true;
     
              checklistUpload('sit_uat');
     
              toggleSection('checklist', 'checklistarrow');
     
          } else {
     
              sitUatCheckbox.checked = false;
     
          }
     
     
     
          // Check if the other three checkboxes should be selected
     
          if (selectedTarget === "targetTEST" || selectedTarget === "targetDev16") {
     
              beginDevelopmentCheckbox.checked = true;
     
              codeReviewCheckbox.checked = true;
     
              unitTestCheckbox.checked = true;
     
              checklistUpload('begin_development');
     
              checklistUpload('code_review');
     
              checklistUpload('unit_test');
     
          } else {
     
              beginDevelopmentCheckbox.checked = false;
     
              codeReviewCheckbox.checked = false;
     
              unitTestCheckbox.checked = false;
     
              checklistUpload('begin_development');
     
              checklistUpload('code_review');
     
              checklistUpload('unit_test');
     
          }
     
     
     
          // Ensure unitTestCheckbox is unchecked if other conditions are false
     
          if (sitUatCheckbox.checked === false && beginDevelopmentCheckbox.checked === false && codeReviewCheckbox.checked === false) {
     
              unitTestCheckbox.checked = false;
     
          }*/
     
      }
     
     
     
     
     
      </script-->
    <script>
        // Define the environments

        const highEnvs = ['sourcePROD', 'sourceDev16', 'sourceTest', 'targetPROD', 'targetDev16', 'targetTEST'];

        const lowerEnvs = ['sourceDev1', 'sourceDev2', 'sourceDev3', 'sourceDev4', 'sourceDev5', 'sourceDev9', 'sourceDev15', 'sourceDev17',

            'targetDev1', 'targetDev2', 'targetDev3', 'targetDev4', 'targetDev5', 'targetDev9', 'targetDev15', 'targetDev17'];



        // Function to update the state of the HtoL checkbox and label

        function updateHtoLCheckboxState() {

            const sourceEnv = document.getElementById('sourceSelect').value;

            const targetEnv = document.getElementById('targetSelect').value;

            const HtoLContainer = document.getElementById('HtoLContainer');

            const HtoLCheckbox = document.getElementById('HtoL');

            const HtoLLabel = document.getElementById('HtoL_lbl');



            if (sourceEnv === '' || targetEnv === '') {

                // If either dropdown is not selected, hide the checkbox

                HtoLContainer.style.visibility = 'hidden';

                HtoLCheckbox.checked = false;

                HtoLLabel.textContent = 'HtoL';

                return;

            }



            const isSourceProd = sourceEnv === 'sourcePROD';

            const isTargetProd = targetEnv === 'targetPROD';

            const isSourceHigh = highEnvs.includes(sourceEnv);

            const isTargetHigh = highEnvs.includes(targetEnv);

            const isSourceLower = lowerEnvs.includes(sourceEnv);

            const isTargetLower = lowerEnvs.includes(targetEnv);



            // Determine the state of the checkbox based on the conditions

            if (isSourceLower && isTargetLower) {

                HtoLLabel.textContent = 'L2L';

                HtoLCheckbox.checked = true;

                HtoLCheckbox.disabled = true;

                HtoLContainer.style.visibility = 'visible';

            } else if (isSourceProd && !isTargetProd) {

                HtoLLabel.textContent = 'H2L';

                HtoLCheckbox.checked = true;

                HtoLCheckbox.disabled = true;

                HtoLContainer.style.visibility = 'visible';

            } else if (!isSourceProd && isTargetProd) {

                HtoLLabel.textContent = 'L2H';

                HtoLCheckbox.checked = true;

                HtoLCheckbox.disabled = true;

                HtoLContainer.style.visibility = 'visible';

            } else if (isSourceHigh && !isTargetProd && isTargetLower) {

                HtoLLabel.textContent = 'H2L';

                HtoLCheckbox.checked = true;

                HtoLCheckbox.disabled = true;

                HtoLContainer.style.visibility = 'visible';

            } else if (isSourceLower && !isSourceProd && isTargetHigh && !isTargetProd) {

                HtoLLabel.textContent = 'L2H';

                HtoLCheckbox.checked = true;

                HtoLCheckbox.disabled = true;

                HtoLContainer.style.visibility = 'visible';

            } else if (isSourceHigh && isTargetHigh && !isSourceProd && !isTargetProd) {

                HtoLLabel.textContent = 'H2H';

                HtoLCheckbox.checked = true;

                HtoLCheckbox.disabled = true;

                HtoLContainer.style.visibility = 'visible';

            } else {

                HtoLContainer.style.visibility = 'hidden';

            }

        }



        // Handle HtoL checkbox click

        function handleHtoL() {

            // Placeholder function if additional handling is needed

        }



        // Add event listeners to the dropdowns to update the checkbox state

        document.getElementById('sourceSelect').addEventListener('change', updateHtoLCheckboxState);

        document.getElementById('targetSelect').addEventListener('change', updateHtoLCheckboxState);



        // Initial update of the checkbox state on page load

        document.addEventListener('DOMContentLoaded', function () {

            updateHtoLCheckboxState();

        });

    </script>
    <script>
        // Define the environments

        var higherEnvironments = ['sourceDev16', 'sourceTest', 'sourcePROD', 'targetDev16', 'targetTEST', 'targetPROD'];

        var lowerEnvironments = ['sourceDev1', 'sourceDev2', 'sourceDev3', 'sourceDev4', 'sourceDev5', 'sourceDev9', 'sourceDev15', 'sourceDev17',

            'targetDev1', 'targetDev2', 'targetDev3', 'targetDev4', 'targetDev5', 'targetDev9', 'targetDev15', 'targetDev17'];



        // Function to update the GitHub merge status checkbox state

        function updateGitHubMergeStatusCheckbox() {

            const sourceEnv = document.getElementById('sourceSelect').value;

            const targetEnv = document.getElementById('targetSelect').value;

            const githubMergeStatusCheckbox = document.getElementById('githubmergestatus');



            if (sourceEnv === '' || targetEnv === '') {

                // If either dropdown is not selected, disable the checkbox

                githubMergeStatusCheckbox.disabled = true;

                return;

            }



            const isSourceHigher = higherEnvironments.includes(sourceEnv);

            const isSourceLower = lowerEnvironments.includes(sourceEnv);

            const isTargetHigher = higherEnvironments.includes(targetEnv);

            const isTargetLower = lowerEnvironments.includes(targetEnv);



            // Determine the state of the checkbox based on the conditions

            if ((isSourceLower && isTargetLower) ||

                (isSourceHigher && isTargetLower) ||

                (isSourceHigher && isTargetHigher)) {

                githubMergeStatusCheckbox.disabled = true;

            } else if (isSourceLower && isTargetHigher) {

                githubMergeStatusCheckbox.disabled = false;

            }

        }



        // Add event listeners to the dropdowns to update the checkbox state

        document.getElementById('sourceSelect').addEventListener('change', updateGitHubMergeStatusCheckbox);

        document.getElementById('targetSelect').addEventListener('change', updateGitHubMergeStatusCheckbox);



        // Initial update of the checkbox state on page load

        document.addEventListener('DOMContentLoaded', updateGitHubMergeStatusCheckbox);

    </script>
    <script>
        function validateFileType() {

            var input = document.getElementById('migrationFileInput');

            var display = document.getElementById('selectedMigrationFileName');

            var error = document.getElementById('errorMessage');

            var file = input.files[0];

            if (file) {

                var fileName = file.name;

                var fileExtension = fileName.split('.').pop().toLowerCase();

                if (fileExtension !== 'csv') {

                    error.textContent = "Error: Only CSV files are allowed.";

                    error.style.display = 'block'; // Ensure error message is visible

                    input.value = '';  // Clear the input

                    display.textContent = '';

                } else {

                    error.textContent = '';

                    error.style.display = 'none'; // Hide error message

                    display.textContent = fileName;

                }

            }

        }

    </script>
    <script type="text/javascript">
        window.addEventListener('load', function () {

            SetFullScreenMode(true);

        });

    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {

            var inputIds = ["BackupTechLeadApprover", "BackupBOApproverROW", "BackupBOApproverEU", "BackupITOwnerApprover", "assigned_to"];

            var listIds = ["backUpTlList", "backUpROWList", "backUpEUList", "backUpITList", "assignedtolist"];



            inputIds.forEach(function (inputId, index) {

                var inputElement = document.getElementById(inputId);

                if (!inputElement) {

                    console.error('Input element with ID ' + inputId + ' not found');

                    return;

                }



                inputElement.addEventListener('input', function () {

                    var input = this.value.toLowerCase();

                    var suggestionsList = document.getElementById(listIds[index]);

                    suggestionsList.innerHTML = "";



                    if (input === "") {

                        return; // If input is empty, clear the suggestions and return

                    }



                    names.forEach(function (user) {

                        if (user.email.toLowerCase().includes(input) || user.name.toLowerCase().includes(input)) {

                            var suggestionItem = document.createElement("li");

                            suggestionItem.textContent = user.name;

                            suggestionItem.addEventListener('click', function () {

                                document.getElementById(inputId).value = user.email;

                                suggestionsList.innerHTML = "";

                            });

                            suggestionItem.style.cursor = "pointer";

                            suggestionsList.appendChild(suggestionItem);

                        }

                    });

                });

            });

        });

    </script>
    <script>
        function validateRequiredFields() {

            const requiredFields = [

                { id: 'pdo', label: 'PDO' },

                { id: 'title', label: 'Title' },

                { id: 'description', label: 'Description' },

                { id: 'sourceSelect', label: 'Source Environment' },

                { id: 'targetSelect', label: 'Target Environment' }

            ];



            // Locate the admin activity select field.

            const adminActivitySelect = document.getElementById("manual_admin_activities");



            const manual_admin_run = document.getElementById("admin_run");

            // Gather all selected options.

            const selectedOptions = Array.from(adminActivitySelect.options).filter(option => option.selected);



            // If no admin activity option is selected, then Migration Template File is required.

            // If one or more options are selected, migrationFileInput becomes optional.

            //alert(manual_admin_run.checked);

            //if (!(manualAdminRun.checked || selectedOptions.length === 0)) {



            if (!manual_admin_run.checked && selectedOptions.length === 0) {

                // If admin_run_checkbox is unchecked and there are selected options, make migration template mandatory

                requiredFields.push({ id: 'migrationFileInput', label: 'Migration Template File' });

            } else {

                // If admin_run_checkbox is checked or no selected options, make migration template optional

                const migrationElement = document.getElementById('migrationFileInput');

                if (migrationElement) {

                    migrationElement.style.borderColor = ''; // Clear any validation styling

                }

            }



            var sourceSelect5 = document.getElementById("sourceSelect").value;

            var targetSelect5 = document.getElementById("targetSelect").value;



            // New condition: If target is PROD and source is not Test

            if (targetSelect5 === 'targetPROD' && sourceSelect5 !== 'sourceTest') {

                alert('If the target is PROD, the source should be Test.');

                return;

            }



            // Add LtoH SP ID to required fields if it is visible

            const ltohSpIdField = document.getElementById('low_sp_id_textbox');

            if (ltohSpIdField && ltohSpIdField.offsetParent !== null) {

                requiredFields.push({ id: 'low_sp_id_textbox', label: 'Enter valid Test Migration SP ID' });

            }



            // Check if GitHub Commit ID and URL are required

            const commitIndicator = document.getElementById('commitIndicator'); // Assuming this element exists

            if (commitIndicator && commitIndicator.style.display === "inline") {

                requiredFields.push({ id: 'githubCommitId', label: 'Commit ID' });

                requiredFields.push({ id: 'githubURL', label: 'GitHub URL' });

            }

            const bipCheckbox = document.getElementById("bip");
            const bipSecurityViewsDropdown = document.getElementById("bip_security_views_dropdown");
            const bipRoleReviewDropdown = document.getElementById("bip_role_review_dropdown");

            let allFieldsValid = true;

            let missingFields = [];


            // Check if BIP is checked and neither dropdown is selected
            if (bipCheckbox.checked) {
                if (!bipSecurityViewsDropdown.value && !bipRoleReviewDropdown.value) {
                    missingFields.push("Select at least either one Security or Review");

                    allFieldsValid = false;
                }
            }





            requiredFields.forEach(field => {

                const element = document.getElementById(field.id);

                if (element && !element.value.trim()) {

                    allFieldsValid = false;

                    missingFields.push(field.label);

                    element.style.borderColor = 'red';

                } else if (element) {

                    element.style.borderColor = ''; // Reset the border color if the field is valid

                }

            });



            /*            const categorySelect = document.getElementById("categorySelect");
           
                     const selectedCategory = categorySelect.value;
           
                     if (selectedCategory !== "non_sox_non_approval") {
           
                         const soxFileInput = document.getElementById('sox_file');
           
                         if (soxFileInput.files.length === 0) {
           
                             allFieldsValid = false;
           
                             missingFields.push('SOX File');
           
                             document.getElementById('sox_file').style.borderColor = 'red';
           
                         } else {
           
                             document.getElementById('sox_file').style.borderColor = '';
           
                         }
           
                     } */



            if (!allFieldsValid) {

                alert('Following mandatory fields must be filled:\n' + missingFields.join('\n'));

            }



            return allFieldsValid;

        }



        function createItem(event) {

            event.preventDefault(); // Prevent form submission for now



            // Validate required fields (excluding SOX file)

            if (!validateRequiredFields()) {

                return;

            }









            // Check if migration file is selected

            /*     var migrationFileInput = document.getElementById('migrationFileInput');
           
                 if (migrationFileInput.files.length === 0) {
           
                     alert('Please upload a Migration Template file .');
           
                     return;
           
                 } */



            try {

                var clientContext = new SP.ClientContext.get_current();

                //var oList = clientContext.get_web().get_lists().getByTitle('PROD - HCM Migration Request Form'); // Update with your list title



                var oList = clientContext.get_web().get_lists().getByTitle('Test Form - Migration'); // Update with your list title







                var itemCreateInfo = new SP.ListItemCreationInformation();

                var oListItem = oList.addItem(itemCreateInfo);



                // Helper function to get element value safely

                function getElementValue(id) {

                    var element = document.getElementById(id);

                    return element ? element.value : '';

                }



                // Helper function to get select element value safely

                function getSelectValue(id) {

                    var element = document.getElementById(id);

                    if (element) {

                        var selectedValue = element.options[element.selectedIndex].value;

                        return selectedValue;

                    }

                    return '';

                }



                // Helper function to get checkbox value safely

                function getCheckboxValue(id) {

                    var element = document.getElementById(id);

                    return element ? element.checked : false;

                }



                // Mapping for Workstream values

                var workstreamMapping = {

                    "DI_Dashboard": "DI - Dashboard",

                    

                    "Integration": "Integration",

                    "Reporting": "Reporting",

                    "WORKFORCE COMPENSATION": "WORKFORCE COMPENSATION",

                    "IAAAP": "IAAAP",

                    "Payroll_Modernization": "Payroll Modernization",

                    "Core HR": "Core HR",

                    "Recruitment": "Recruitment",

                    "Talent": "Talent",

                    "Learning": "Learning",

                    "KD42-EU-Payroll": "KD42_EU_Payroll",

                    "uspayrollsupport": "US Payroll Support",

                    "testing_purpose": "Testing Purpose",
                    "security": "HRSSA - Security"

                };



                // Mapping for Sub-Workstream values

                var subWorkstreamMapping = {

                    "core_hr_absence_benefits": "Core HR - Absence & Benefits",

                    "row_nprl": "ROW - NPRL",

                    "eu_nprl": "EU - NPRL",

                    "eu_row_nprl_global": "EU & ROW - NPRL - GLOBAL",

                    "row_prl": "ROW - PRL",

                    "eu_prl": "EU- PRL",

                    "uch": "UCH",

                    "us_payroll": "US-PAYROLL",

                    "di_dashboard": "DI DASHBOARD",

                    "payroll_modernization": "PAYROLL MODERNIZATION",

                    

                    "reporting_eu": "Reporting - EU",

                    "reporting_row": "Reporting - ROW",

                    "iaaap": "IAAAP",

                    "iaaap_row": "IAAAP-ROW",

                    "iaaap_eu": "IAAAP-EU",

                    "iaaap_reports": "IAAAP_REPORTS",

                    "learning": "Learning",

                    "workforce_compensation": "WORKFORCE COMPENSATION",

                    "recruitment": "Recruitment",

                    "talent": "Talent",

                    "kd42_EU_Payroll": "KD42_EU_Payroll",

                    "uspayrollsupport": "US Payroll Support",

                    "testing_purpose": "Testing Purpose",
                    "security": "HRSSA - Security"

                };



                // Mapping for PDO values

                var pdoMapping = {

                    "corehr": "Core HR",

                    "falcon": "Falcon",

                    "blackbox": "Data Avengers",

                    "eagle": "Eagle",

                    "phoenix": "Phoenix",

                    "frontier": "Frontier",

                    "insights": "Insights",

                    "trex": "T-Rex",

                    "learning": "Learning",

                    "mustang": "Mustang",

                    "recruitment": "Recruitment",

                    "talent": "Talent",

                    "cardinals": "Cardinals",

                    "kdfourtytwo": "KD42",

                    "uspayrollsupport": "US Payroll Support",

                    "testpdo": "Test PDO"

                };



                // Mapping for Source Environment values

                var sourceMapping = {

                    "sourceDev1": "DEV1",

                    "sourceDev2": "DEV2",

                    "sourceDev3": "DEV3",

                    "sourceDev4": "DEV4",

                    "sourceDev5": "DEV5",

                    "sourceDev9": "DEV9",

                    "sourceTest": "TEST",

                    "sourceDev15": "DEV15",

                    "sourceDev16": "DEV16",

                    "sourceDev17": "Dev17",

                    "sourcePROD": "PROD"

                };



                // Mapping for Target Environment values (same as source but different order)

                var targetMapping = {

                    "targetPROD": "PROD",

                    "targetDev17": "Dev17",

                    "targetDev16": "DEV16",

                    "targetDev15": "DEV15",

                    "targetTEST": "TEST",

                    "targetDev9": "DEV9",

                    "targetDev5": "DEV5",

                    "targetDev4": "DEV4",

                    "targetDev3": "DEV3",

                    "targetDev2": "DEV2",

                    "targetDev1": "DEV1"

                };



                // Get the form values

                var title = getElementValue('title');

                var description = getElementValue('description');

                var comments = getElementValue('comments');

                var customerPOC = getElementValue('customer_poc');

                var assigned_To = getElementValue('assigned_to');

                var pdo = pdoMapping[getSelectValue('pdo')] || getSelectValue('pdo');

                var workstream = workstreamMapping[getSelectValue('workstream')] || getSelectValue('workstream');

                var subWorkstream = subWorkstreamMapping[getSelectValue('sub-workstream')] || getSelectValue('sub-workstream');

                var priority = getSelectValue('prioritySelect');

                var category = getSelectValue('categorySelect');

                var releaseIteration = getElementValue('releaseiteration');

                var twoThirtyId = getElementValue('TWOTHIRTYID');

                var emergencyRequest = getCheckboxValue('toggleSwitch');

                var dueDateTime = getElementValue('datetime');

                var soxFreeze = getCheckboxValue('sox');

                var sensitivePIInfo = getCheckboxValue('spi');

                var adminRunSupport = getCheckboxValue('admin_run');

                var sourceInstance = sourceMapping[getSelectValue('sourceSelect')] || getSelectValue('sourceSelect');

                var targetEnvironment = targetMapping[getSelectValue('targetSelect')] || getSelectValue('targetSelect');

                var githubCommitId = getElementValue('githubCommitId');

                var githubURL = getElementValue('githubURL');

                var githubMergeStatus = getCheckboxValue('githubmergestatus');

                var lowSpId = getElementValue('low_sp_id_textbox'); // Get LtoH SP ID value

                

                var lookup = getCheckboxValue('lookup');

                var valueset = getCheckboxValue('valueset');

                var fastFormula = getCheckboxValue('fast-formula');

                var hcmExtract = getCheckboxValue('hcm-extract');

                var payrollFlow = getCheckboxValue('payroll-flow');

                var udt = getCheckboxValue('udt');

                var otbiAnalysis = getCheckboxValue('otbi');

                var cwbUpdate = getCheckboxValue('cwbUpdate');

                var balanceGroups = getCheckboxValue('balanceGroups');

                var balanceGroupsUsages = getCheckboxValue('balanceGroupsUsages');

                var hdlDataFix = getCheckboxValue('hdlDataFix');

                var manualMigration = getCheckboxValue('manualMigration');

                var partialMigration = getCheckboxValue('partialMigration');

                var uncheckAll = getCheckboxValue('uncheck_all');

                var allChecklist = getCheckboxValue('all_checklist');

                var inScope = document.getElementById('HtoL_lbl').textContent; // Get HtoL label text



                var select_Manual_Admin_Activity_Element = document.getElementById('manual_admin_activities');

                var selected_Manual_Admin_Activity_Options = Array.from(select_Manual_Admin_Activity_Element.selectedOptions);

                var admin_activity_displayTexts = selected_Manual_Admin_Activity_Options.map(option => option.textContent).join(',');







                var manual_admin_activity = admin_activity_displayTexts



                // Get the new fields

                var backupTechLeadApprover = getElementValue('BackupTechLeadApprover');

                var backupBOApproverROW = getElementValue('BackupBOApproverROW');

                var backupBOApproverEU = getElementValue('BackupBOApproverEU');

                var backupITOwnerApprover = getElementValue('BackupITOwnerApprover');
                var bip = getCheckboxValue('bip');


                // Map workstream and sub-workstream values

                workstream = workstreamMapping[workstream] || workstream;

                subWorkstream = subWorkstreamMapping[subWorkstream] || subWorkstream;



                // Function to upload files and set the corresponding field value

                // Function to upload files and set the corresponding field value

                function uploadFileAndSetField(fileInputId, fieldName) {

                    return new Promise((resolve, reject) => {

                        var fileInput = document.getElementById(fileInputId);

                        if (fileInput.files.length > 0) {

                            var file = fileInput.files[0];



                            // Directly use the Blob object without converting it

                            var siteUrl = _spPageContextInfo.webAbsoluteUrl;

                            var uploadUrl = siteUrl + "/_api/web/lists/getbytitle('Migration_Templates')/RootFolder/files/add(url='" + file.name + "',overwrite=true)";



                            fetch(uploadUrl, {

                                method: 'POST',

                                headers: {

                                    'Accept': 'application/json;odata=verbose',

                                    'X-RequestDigest': document.getElementById("__REQUESTDIGEST").value,

                                },

                                body: file // Directly use the File object, which is a type of Blob

                            })

                                .then(response => {

                                    if (!response.ok) {

                                        throw new Error('Network response was not ok: ' + response.statusText);

                                    }

                                    return response.json();

                                })

                                .then(data => {

                                    if (data && data.d && data.d.ServerRelativeUrl) {

                                        var fileUrl = data.d.ServerRelativeUrl;

                                        oListItem.set_item(fieldName, fileUrl);

                                        resolve();

                                    } else {

                                        throw new Error('Unexpected response format: ' + JSON.stringify(data));

                                    }

                                })

                                .catch(error => {

                                    console.error('Error uploading file:', error);

                                    alert('Error uploading file: ' + error.message);

                                    reject(error.message);

                                });

                        } else {

                            resolve();

                        }

                    });

                }







                // Function to set fields and update the item

                function setFieldsAndSaveItem(userFieldValue, backupTechLeadApproverFieldValue, backupBOApproverROWFieldValue, backupBOApproverEUFieldValue, backupITOwnerApproverFieldValue) {

                    // Chain file uploads

                    Promise.all([

                        uploadFileAndSetField('mig_config_file', 'MIGRATION_CONFIG_DOC_FILE_LINK'),

                        uploadFileAndSetField('begin_development_file', 'BEGIN_DEVELOPMENT_FILE_LINK'),

                        uploadFileAndSetField('unit_test_file', 'UNIT_TEST_FILE_LINK'),

                        uploadFileAndSetField('code_review_file', 'CODE_REVIEW_FILE_LINK'),

                        uploadFileAndSetField('sit_uat_file', 'SIT_UAT_FILE_LINK'),

                        uploadFileAndSetField('migrationFileInput', 'Migration_x0020_Template_x0020_C'),

                        uploadFileAndSetField('sox_file', 'SOX_x0020_SP_x0020_URL'),

                        uploadFileAndSetField('spi_file', 'SPI_x0020_SP_x0020_URL')

                    ])

                        .then(() => {

                            // Set the remaining item fields

                            var migrationCheckboxIds = [
                                'bip',
                                'lookup',
                                'valueset',
                                'fast-formula',
                                'hcm-extract',
                                'payroll-flow',
                                'udt',
                                'otbi',
                                'cwbUpdate',
                                'balanceGroups',
                                'balanceGroupsUsages',
                                'hdlDataFix',
                                'manualMigration',
                                'partialMigration'
                                // (add 'HtoL' here too if you ever want that hidden checkbox in the scope)
                            ];


                            // ————————————————
                            // 2) Pull out only the checked ones
                            // ———————————————
                            var migrationScopeValues = migrationCheckboxIds
                                .filter(function (id) {
                                    var cb = document.getElementById(id);
                                    return cb && cb.checked;
                                })
                                .map(function (id) {
                                    return document.getElementById(id).value;
                                });


                            oListItem.set_item('isFromHTMLForm', 'Yes');

                            oListItem.set_item('Title', title);

                            oListItem.set_item('DESCRIPTION', description);

                            oListItem.set_item('COMMENTS', comments);

                            oListItem.set_item('PDO', pdo);

                            oListItem.set_item('WORKSTREAM', workstream);

                            oListItem.set_item('SUB_x002d_WORKSTREAM', subWorkstream);

                            oListItem.set_item('PRIORITY', priority);

                            oListItem.set_item('CATEGORY', category);

                            oListItem.set_item('RELEASE_x0020_ITERATION', releaseIteration);

                            oListItem.set_item('REF_x002e__x0020_SP_x0020_ID_x00', twoThirtyId);

                            oListItem.set_item('EMERGENCY_x0020_REQUEST', emergencyRequest);

                            oListItem.set_item('DUE_x0020_DATE_x0020_AND_x0020_T', dueDateTime);

                            oListItem.set_item('Does_x0020_it_x0020_have_x0020_F', soxFreeze);

                            oListItem.set_item('Have_x0020_you_x0020_checked_x00', sensitivePIInfo);

                            oListItem.set_item('MANUAL_x0020_PROD_x0020_ADMIN_x0', adminRunSupport);

                            //if (userFieldValue) {

                            oListItem.set_item('Customer_x0020_POC', customerPOC);

                            //}

                            oListItem.set_item('MIGRATION_x0020_SCOPE', migrationScopeValues);




                            oListItem.set_item('SOURCE_x0020_ENVIRONMENT', sourceInstance);

                            oListItem.set_item('TARGET_x0020_ENVIRONMENT', targetEnvironment);

                            oListItem.set_item('GitHub_x0020_Commit_x0020_ID', githubCommitId);

                            oListItem.set_item('Github_x0020_URL', githubURL);

                            oListItem.set_item('GitHub_x0020_Merge_x0020_Status', githubMergeStatus);

                            oListItem.set_item('Lower_to_Higher_SP_ID', lowSpId); // Set LtoH SP ID field

                            oListItem.set_item('BIP', bip);

                            oListItem.set_item('Lookup', lookup);

                            oListItem.set_item('Valueset', valueset);

                            oListItem.set_item('Fast_x0020_Formula', fastFormula);

                            oListItem.set_item('HCM_x0020_Extract', hcmExtract);

                            oListItem.set_item('Payroll_x0020_Flow', payrollFlow);

                            oListItem.set_item('UDT', udt);

                            oListItem.set_item('OTBI_x0020_Analysis', otbiAnalysis);

                            oListItem.set_item('CWB_x0020_Update', cwbUpdate);

                            oListItem.set_item('Balance_x0020_Groups', balanceGroups);

                            oListItem.set_item('Balance_x0020_Groups_x0020_Usage', balanceGroupsUsages);

                            oListItem.set_item('HDL_x0020_Data_x0020_Fix', hdlDataFix);

                            oListItem.set_item('MANUAL_x0020_MIGRATION_x0020_REQ', manualMigration);

                            oListItem.set_item('Partial_x0020_Migration', partialMigration);

                            oListItem.set_item('Uncheck_x0020_All', uncheckAll);

                            oListItem.set_item('All_x0020_Checklist', allChecklist);

                            oListItem.set_item('IN_SCOPE', inScope); // Set IN_SCOPE field

                            if (backupTechLeadApproverFieldValue) {

                                oListItem.set_item('BACKUP_x0020_TL_x0020_APPROVER', backupTechLeadApproverFieldValue);

                            }

                            if (backupBOApproverROWFieldValue) {

                                oListItem.set_item('BACKUP_x0020_ROW_x0020_BO_x0020_', backupBOApproverROWFieldValue);

                            }

                            if (backupBOApproverEUFieldValue) {

                                oListItem.set_item('BACKUP_x0020_EU_x0020_BO_x0020_A', backupBOApproverEUFieldValue);

                            }

                            if (backupITOwnerApproverFieldValue) {

                                oListItem.set_item('BACKUP_x0020_IT_x0020_OWNER_x002', backupITOwnerApproverFieldValue);

                            }

                            oListItem.set_item('Manual_Admin_Activities_String', manual_admin_activity);





                            oListItem.update();



                            clientContext.executeQueryAsync(

                                function () {

                                    alert('HCM Migration Request ' + oListItem.get_id() + ' Successfully Submitted.');

                                    window.location.reload();

                                },

                                function (sender, args) {

                                    alert('Error creating item: ' + args.get_message() + '\n' + args.get_stackTrace());

                                }

                            );

                        })

                        .catch((error) => {

                            alert('Error during file upload process: ' + error);

                        });

                }



                // Function to resolve user fields

                function resolveUserField(userName) {

                    return new Promise((resolve, reject) => {

                        if (!userName) {

                            resolve(null); // If no user name is provided, resolve with null

                            return;

                        }

                        var user = clientContext.get_web().ensureUser(userName);

                        clientContext.load(user);

                        clientContext.executeQueryAsync(

                            function () {

                                var userFieldValue = SP.FieldUserValue.fromUser(user.get_loginName());

                                resolve(userFieldValue);

                            },

                            function (sender, args) {

                                alert('Error resolving user: ' + args.get_message() + '\n' + args.get_stackTrace());

                                resolve(null); // Resolve with null if user resolution fails

                            }

                        );

                    });

                }



                // Resolve user fields

                Promise.all([

                    resolveUserField(assigned_To),

                    resolveUserField(backupTechLeadApprover),

                    resolveUserField(backupBOApproverROW),

                    resolveUserField(backupBOApproverEU),

                    resolveUserField(backupITOwnerApprover)

                ]).then(values => {

                    setFieldsAndSaveItem(values[0], values[1], values[2], values[3], values[4]);

                }).catch(error => {

                    alert('Error resolving user fields: ' + error);

                });



            } catch (e) {

                alert('Error: ' + e.message);

            }

        }





    </script>
    <script>
        function resetForm() {

            // document.getElementById('hcm_form').reset();

            //location.reload();

            window.location.reload();

        }

    </script>
    <script>
        function checkVisibility() {

            var sourceSelect = document.getElementById("sourceSelect").value;

            var targetSelect = document.getElementById("targetSelect").value;

            var sp_id_textbox = document.getElementById("low_sp_id_label");

            var sp_id_label = document.getElementById("low_sp_id_textbox");



            if ((sourceSelect === "sourceTest" || sourceSelect === "sourceDev16") && targetSelect === "targetPROD") {

                sp_id_textbox.style.display = "block";

                sp_id_label.style.display = "block";

            } else {

                sp_id_textbox.style.display = "none";

                sp_id_label.style.display = "none";

            }

        }



        document.addEventListener("DOMContentLoaded", function () {

            document.getElementById("sourceSelect").addEventListener("change", checkVisibility);

            document.getElementById("targetSelect").addEventListener("change", checkVisibility);

            checkVisibility(); // Initial check on page load

        });

    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {

            const categorySelect = document.getElementById("categorySelect");



            // Function to add the special Non-Sox / Non-Payroll option if the current month is March, June, September, November, or December

            function addSpecialSoxOption() {

                const currentDate = new Date();

                const currentMonth = currentDate.getMonth(); // getMonth() returns month index starting from 0 (January) to 11 (December)



                // Check if the current month is March (2), June (5), September (8), November (10), or December (11)

                if ([2, 5, 8, 10, 11].includes(currentMonth)) {

                    const specialOption = document.createElement("option");

                    specialOption.value = "non_sox_non_approval";

                    specialOption.textContent = "Non-Sox / Non-Payroll";

                    categorySelect.appendChild(specialOption);

                }

            }



            // Call the function to add the special Non-Sox / Non-Payroll option

            addSpecialSoxOption();



            // Add your existing onchange event handler if it is not already defined

            categorySelect.addEventListener("change", handleMigrationSelection);

        });

    </script>
    <script>
        // Listen for changes on the "manual_admin_activities" select element.

        document.getElementById("manual_admin_activities").addEventListener("change", function () {

            // Determine if any option is selected.

            const hasSelection = Array.from(this.options).some(option => option.selected);





            if (hasSelection) {

                // Force the "manualMigration" checkbox to be checked.

                const manualMigration = document.getElementById("manualMigration");

                const commitIndicator = document.getElementById("commitIndicator");

                commitIndicator.style.display = "none";



                if (manualMigration) {

                    manualMigration.checked = true;

                }



                // Uncheck all checkboxes within the checkbox items except for "manualMigration".

                // This selector finds all checkboxes inside a container having "checkbox-item" class.

                const checkboxes = document.querySelectorAll(".checkbox-item input[type='checkbox']");

                checkboxes.forEach(function (checkbox) {

                    if (checkbox.id !== "manualMigration") {

                        checkbox.checked = false;

                    }

                });

            }

        });

    </script>
    <script>
        window.onload = function () {





            var subWorkstreamDropdown = document.getElementById("sub-workstream");

            var manualAdminActivitiesDropdown = document.getElementById("manual_admin_activities");



            subWorkstreamDropdown.addEventListener("change", function () {



                var selectedValue = subWorkstreamDropdown.value;

                //alert(selectedValue);

                var options = manualAdminActivitiesDropdown.options;



                // Deselect all options in manual_admin_activities

                for (var i = 0; i < options.length; i++) {

                    options[i].selected = false;

                }



                // Check if the selected value is either "vbcs_migration" or "page_personalization"

                if (selectedValue === "vbcs_migration" || selectedValue === "page_personalization") {



                    // Find and select the corresponding option in manual_admin_activities

                    for (var i = 0; i < options.length; i++) {

                        if (options[i].value.includes(selectedValue)) {

                            options[i].selected = true;

                            break;

                        }

                    }

                }

            });

        };

        function updateTargetSelect() {
            var pdoSelect = document.getElementById("pdo");
            var targetSelect = document.getElementById("targetSelect");
            var prodOption = targetSelect.querySelector('option[value="targetPROD"]');
            var supportText = document.querySelector('.support-text'); // Select the support-text element
            var customerPocLabel = document.querySelector('label[for="customer_poc"]'); // Label for customer_poc
            var customerPocInput = document.getElementById("customer_poc"); // Input field for customer_poc

            // Show or hide the PROD option based on PDO selection
            /*if (pdoSelect.value === "blackbox" || pdoSelect.value === "frontier" || pdoSelect.value === "phoenix" || pdoSelect.value === "corehr" || pdoSelect.value === "falcon") {
                prodOption.style.display = "block";
            } else {
                prodOption.style.display = "none";
            }*/

            // Show or hide the support-text based on PDO selection
            if (pdoSelect.value === "kdfourtytwo") {
                supportText.style.display = "block"; // Show the support-text

                // Update the label to "PDO POC"
                if (customerPocLabel) {
                    customerPocLabel.textContent = "PDO POC";
                }

                // Update the input value and make it read-only
                if (customerPocInput) {
                    customerPocInput.value = "KD42@groups.ford.com";
                    customerPocInput.readOnly = true;
                }
            } else {
                supportText.style.display = "none"; // Hide the support-text

                // Reset the label and input field
                if (customerPocLabel) {
                    customerPocLabel.textContent = "Customer POC";
                }

                if (customerPocInput) {
                    customerPocInput.value = "";
                    customerPocInput.readOnly = false;
                }
            }
        }

    </script>
</body>

</html>